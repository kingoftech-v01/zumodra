{% extends "base.html" %}
{% load wagtailcore_tags wagtailimages_tags %}

{% block head_title %}{{ page.title }} - Zumodra{% endblock head_title %}

{% block content %}

{% include 'header.html' %}

<!-- Slider -->
<section class="slider">
    <!-- blog_img w-full h-full object-cover -->
    <div class="slider_inner relative lg:h-[680px] md:h-[520px] h-[350px] sm:pt-20 pt-16 overflow-hidden">
        {% image page.featured_image max-1920x1080 as img %}
          <img src="{{ img.url }}" alt="{{ page.title }}" class="w-full h-full object-cover" />
    </div>
</section>

<section class="blog_detail lg:py-20 sm:py-14 py-10">
  <div class="container flex justify-center">
    <div class="blog_content lg:w-5/6 w-full">

    <!-- Rendu des tags -->
    {% if page.tags.all %}
      <ul class="list_tags flex flex-wrap gap-3 gap-y-4">
        {% for tag in page.tags.all %}
          <li>
            <a href="{% url 'tagged_posts' tag.slug %}" class="tag -large block text-sm font-semibold bg-surface hover:bg-primary hover:text-white">
              {{ tag.name }}
            </a>
          </li>
        {% endfor %}
      </ul>
    {% endif %}

      <!-- Titre de l'article -->
      <h2 class="heading2 title mt-4">{{ page.title }}</h2>

      <!-- Meta infos -->
      <div class="flex flex-wrap items-center justify-between gap-8 gap-y-4 mt-4">
        <div class="flex flex-wrap items-center gap-4">
          <div class="flex items-center gap-3">
            <img src="{{ page.featured_image.url }}" alt="author image" class="flex-shrink-0 w-12 h-12 rounded-full" />
            <span>
              <span class="text-placehover">by </span>
              <span class="blog_author">{{ page.owner.get_full_name }}</span>
            </span>
          </div>
          <div class="line w-px h-4 bg-line"></div>
          <div class="date flex items-center gap-2">
            <span class="ph ph-calendar-blank text-xl"></span>
            <span class="blog_date caption1">{{ page.publishing_date|date:"F j, Y" }}</span>
          </div>
        </div>
        <!-- Ajoutez ici d'autres métadonnées comme commentaires, vue, temps lecture si disponibles -->
      </div>

<div class="prose max-w-none mt-6">

  {% for block in page.body %}
  
    {% if block.block_type == "paragraph" %}
      <p class="body2 md:mt-10 mt-7">{{ block.value|richtext }}</p>

    {% elif block.block_type == "heading" %}
      <h1 class="heading1 md:mt-10 mt-7">{{ block.value }}</h1>
    {% elif block.block_type == "heading2" %}
      <h2 class="heading2 md:mt-10 mt-7">{{ block.value }}</h2>
    {% elif block.block_type == "heading3" %}
      <h3 class="heading3 md:mt-10 mt-7">{{ block.value }}</h3>
    {% elif block.block_type == "heading4" %}
      <h4 class="heading4 md:mt-10 mt-7">{{ block.value }}</h4>
    {% elif block.block_type == "heading5" %}
      <h5 class="heading5 md:mt-10 mt-7">{{ block.value }}</h5>
    {% elif block.block_type == "heading6" %}
      <h6 class="heading6 md:mt-10 mt-7">{{ block.value }}</h6>

    {% elif block.block_type == "quote" %}
        <div class="qoute md:mt-10 mt-7 py-8 px-10 rounded-xl border-l-4 border-primary bg-surface">
            <h4 class="heading4">" {{ block.value.quote }} "</h4>
            <h6 class="flex items-center gap-2 mt-2 heading6 text-secondary">
                <span class="ph ph-minus"></span>
                {% if block.value.author %}
                <span class="font-semibold">{{ block.value.author }}</span>
                <span class="icon-slash text-5xl opacity-10 duration-300"></span>
                {% endif %}
                {% if block.value.source %}
                <span>{{ block.value.source }}</span>
                {% endif %}
            </h6>
        </div>

    {% elif block.block_type == "image" %}
      <div class="images grid sm:grid-cols-1 gap-7.5 md:mt-10 mt-7">
        {% image block.value fill-1920x1080 as img %}
        <img src="{{ img.url }}" alt="{{ block.value.title }}" class="rounded-xl" />
      </div>

    {% elif block.block_type == "code" %}
      <pre class="bg-gray-900 text-green-400 p-4 rounded mt-6 overflow-auto"><code>{{ block.value }}</code></pre>

    {% elif block.block_type == "unordered_list" %}
        <ul class="list-none pl-5 mt-4 flex flex-col gap-3">
            {% for item in block.value %}
            <li class="flex items-start gap-3 body2">
                <!-- Icône personnalisable ici -->
                <span class="mt-[0.3rem] text-primary">
                <!-- Placez ici votre icône SVG ou classe d'icône -->
                <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20" aria-hidden="true">
                    <circle cx="10" cy="10" r="5" />
                </svg>
                </span>
                <p class="body2">{{ item }}</p>
            </li>
            {% endfor %}
        </ul>

    {% elif block.block_type == "ordered_list" %}
        <ol class="list-none pl-5 mt-4 flex flex-col gap-3">
            {% for item in block.value %}
            <li class="flex items-start gap-3 body2">
                <!-- Icône personnalisée avec numéro -->
                <span class="mt-[0.3rem] font-semibold text-primary">
                {{ forloop.counter }}.
                </span>
                <p class="body2">{{ item }}</p>
            </li>
            {% endfor %}
        </ol>

    {% elif block.block_type == "table" %}
        <div class="overflow-x-auto rounded-lg border border-gray-300 shadow-sm mt-6">
            <table class="min-w-full table-auto border-collapse text-left text-sm text-gray-700">
            <caption class="sr-only">{{ block.value.caption }}</caption>
            <thead class="bg-gray-100">
                <tr>
                {% for header_cell in block.value.header %}
                    <th class="border border-gray-300 px-6 py-3 font-semibold text-gray-900 uppercase tracking-wide text-xs select-none">
                    {{ header_cell }}
                    </th>
                {% endfor %}
                </tr>
            </thead>
            <tbody class="divide-y divide-gray-200">
                {% for row in block.value.rows %}
                <tr class="even:bg-gray-50 hover:bg-gray-100 transition-colors">
                    {% for cell in row.cells %}
                    <td class="border border-gray-300 px-6 py-4 align-top whitespace-normal break-words">
                        {{ cell|richtext }}
                    </td>
                    {% endfor %}
                </tr>
                {% endfor %}
            </tbody>
            </table>
        </div>

    {% else %}
      {{ block.value }}
    {% endif %}

  {% endfor %}
</div>


      <!-- Extrait -->
      {% if page.excerpt %}
        <p class="body2 md:mt-10 mt-7">{{ page.excerpt }}</p>
      {% endif %}

    </div>
  </div>
</section>

{% endblock content %}
