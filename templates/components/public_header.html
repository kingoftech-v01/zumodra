{% comment %}
=============================================================================
   ZUMODRA PUBLIC HEADER - REDESIGNED FOR OPTIMAL UX
=============================================================================

   File: templates/components/public_header.html
   Purpose: Main navigation header for public-facing pages

   Clear Navigation Structure:
   - Find Work (for freelancers/candidates)
   - Find Talent (for employers/companies)
   - Company Info
   - Blog

   NO CDN DEPENDENCIES - Uses local Phosphor icons

   Author: Rhematek Solutions
   Last Updated: 2026-01-10
=============================================================================
{% endcomment %}

{% load i18n static %}

<header id="header" class="header sticky top-0 z-50 {% if transparent %}bg-transparent{% else %}bg-white shadow-sm{% endif %} transition-all duration-300"
        x-data="{ mobileMenuOpen: false, scrolled: false }"
        x-init="window.addEventListener('scroll', () => { scrolled = window.scrollY > 50 })"
        :class="{ 'bg-white shadow-md': scrolled || !{{ transparent|default:'false' }} }">

    <div class="container mx-auto">
        <div class="flex items-center justify-between h-20 px-4">

            {# ========== LOGO ========== #}
            <div class="flex items-center">
                <a href="{% url 'home' %}" class="flex items-center" aria-label="Zumodra Home">
                    {# Logo for transparent header #}
                    <img src="{% static 'assets/images/rhematekCS.png' %}"
                         alt="Zumodra"
                         class="h-10 w-auto transition-opacity duration-300"
                         :class="{ 'hidden': scrolled && {{ transparent|default:'false' }} }" />
                    {# Logo for solid header #}
                    <img src="{% static 'assets/images/rhematekC.png' %}"
                         alt="Zumodra"
                         class="h-10 w-auto transition-opacity duration-300 {% if transparent %}hidden{% endif %}"
                         :class="{ 'block': scrolled || !{{ transparent|default:'false' }}, 'hidden': !scrolled && {{ transparent|default:'false' }} }" />
                </a>
            </div>

            {# ========== DESKTOP NAVIGATION ========== #}
            <nav class="hidden lg:flex items-center gap-1" aria-label="Main navigation">
                <ul class="flex items-center gap-1">

                    {# Home #}
                    <li>
                        <a href="{% url 'home' %}"
                           class="px-4 py-2 rounded-lg font-medium transition-all duration-200 {% if transparent %}text-white hover:bg-white/10{% else %}text-gray-700 hover:bg-gray-100{% endif %}"
                           :class="{ 'text-gray-700 hover:bg-gray-100': scrolled }">
                            {% trans 'Home' %}
                        </a>
                    </li>

                    {# Find Work (For Candidates/Freelancers) #}
                    <li class="relative" x-data="{ open: false }" @mouseenter="open = true" @mouseleave="open = false">
                        <button class="px-4 py-2 rounded-lg font-medium transition-all duration-200 flex items-center gap-1 {% if transparent %}text-white hover:bg-white/10{% else %}text-gray-700 hover:bg-gray-100{% endif %}"
                                :class="{ 'text-gray-700 hover:bg-gray-100': scrolled }"
                                aria-expanded="false"
                                @click="open = !open">
                            {% trans 'Find Work' %}
                            <span class="ph-bold ph-caret-down text-xs transition-transform duration-200" :class="{ 'rotate-180': open }"></span>
                        </button>
                        <div x-show="open"
                             x-transition:enter="transition ease-out duration-200"
                             x-transition:enter-start="opacity-0 scale-95"
                             x-transition:enter-end="opacity-100 scale-100"
                             x-transition:leave="transition ease-in duration-150"
                             x-transition:leave-start="opacity-100 scale-100"
                             x-transition:leave-end="opacity-0 scale-95"
                             class="absolute top-full left-0 mt-2 w-64 bg-white rounded-xl shadow-lg border border-gray-200 py-2 z-50"
                             style="display: none;">
                            <a href="{% url 'careers:job_list' %}"
                               class="flex items-center gap-3 px-4 py-3 text-gray-700 hover:bg-gray-50 transition-colors">
                                <span class="ph-bold ph-briefcase text-xl text-primary"></span>
                                <div>
                                    <div class="font-medium">{% trans 'Browse Jobs' %}</div>
                                    <div class="text-xs text-gray-500">{% trans 'Find your next opportunity' %}</div>
                                </div>
                            </a>
                            <hr class="my-2 border-gray-100">
                            <a href="{% url 'become_seller' %}"
                               class="flex items-center gap-3 px-4 py-3 text-gray-700 hover:bg-gray-50 transition-colors">
                                <span class="ph-bold ph-user-plus text-xl text-primary"></span>
                                <div>
                                    <div class="font-medium">{% trans 'Become a Freelancer' %}</div>
                                    <div class="text-xs text-gray-500">{% trans 'Start offering your services' %}</div>
                                </div>
                            </a>
                        </div>
                    </li>

                    {# Find Talent (For Employers) #}
                    <li class="relative" x-data="{ open: false }" @mouseenter="open = true" @mouseleave="open = false">
                        <button class="px-4 py-2 rounded-lg font-medium transition-all duration-200 flex items-center gap-1 {% if transparent %}text-white hover:bg-white/10{% else %}text-gray-700 hover:bg-gray-100{% endif %}"
                                :class="{ 'text-gray-700 hover:bg-gray-100': scrolled }"
                                aria-expanded="false"
                                @click="open = !open">
                            {% trans 'Find Talent' %}
                            <span class="ph-bold ph-caret-down text-xs transition-transform duration-200" :class="{ 'rotate-180': open }"></span>
                        </button>
                        <div x-show="open"
                             x-transition:enter="transition ease-out duration-200"
                             x-transition:enter-start="opacity-0 scale-95"
                             x-transition:enter-end="opacity-100 scale-100"
                             x-transition:leave="transition ease-in duration-150"
                             x-transition:leave-start="opacity-100 scale-100"
                             x-transition:leave-end="opacity-0 scale-95"
                             class="absolute top-full left-0 mt-2 w-64 bg-white rounded-xl shadow-lg border border-gray-200 py-2 z-50"
                             style="display: none;">
                            <a href="{% url 'services:service_list' %}"
                               class="flex items-center gap-3 px-4 py-3 text-gray-700 hover:bg-gray-50 transition-colors">
                                <span class="ph-bold ph-storefront text-xl text-primary"></span>
                                <div>
                                    <div class="font-medium">{% trans 'Browse Services' %}</div>
                                    <div class="text-xs text-gray-500">{% trans 'Find professional services' %}</div>
                                </div>
                            </a>
                            <hr class="my-2 border-gray-100">
                            <a href="{% url 'become_buyer' %}"
                               class="flex items-center gap-3 px-4 py-3 text-gray-700 hover:bg-gray-50 transition-colors">
                                <span class="ph-bold ph-users-three text-xl text-primary"></span>
                                <div>
                                    <div class="font-medium">{% trans 'Hire Talent' %}</div>
                                    <div class="text-xs text-gray-500">{% trans 'Post jobs & build your team' %}</div>
                                </div>
                            </a>
                        </div>
                    </li>

                    {# Company #}
                    <li class="relative" x-data="{ open: false }" @mouseenter="open = true" @mouseleave="open = false">
                        <button class="px-4 py-2 rounded-lg font-medium transition-all duration-200 flex items-center gap-1 {% if transparent %}text-white hover:bg-white/10{% else %}text-gray-700 hover:bg-gray-100{% endif %}"
                                :class="{ 'text-gray-700 hover:bg-gray-100': scrolled }"
                                aria-expanded="false"
                                @click="open = !open">
                            {% trans 'Company' %}
                            <span class="ph-bold ph-caret-down text-xs transition-transform duration-200" :class="{ 'rotate-180': open }"></span>
                        </button>
                        <div x-show="open"
                             x-transition:enter="transition ease-out duration-200"
                             x-transition:enter-start="opacity-0 scale-95"
                             x-transition:enter-end="opacity-100 scale-100"
                             x-transition:leave="transition ease-in duration-150"
                             x-transition:leave-start="opacity-100 scale-100"
                             x-transition:leave-end="opacity-0 scale-95"
                             class="absolute top-full left-0 mt-2 w-56 bg-white rounded-xl shadow-lg border border-gray-200 py-2 z-50"
                             style="display: none;">
                            <a href="{% url 'about' %}" class="block px-4 py-2.5 text-gray-700 hover:bg-gray-50 transition-colors rounded-lg mx-2">
                                {% trans 'About Us' %}
                            </a>
                            <a href="{% url 'pricing' %}" class="block px-4 py-2.5 text-gray-700 hover:bg-gray-50 transition-colors rounded-lg mx-2">
                                {% trans 'Pricing' %}
                            </a>
                            <a href="{% url 'contact_us' %}" class="block px-4 py-2.5 text-gray-700 hover:bg-gray-50 transition-colors rounded-lg mx-2">
                                {% trans 'Contact Us' %}
                            </a>
                            <hr class="my-2 border-gray-100">
                            <a href="{% url 'faq' %}" class="block px-4 py-2.5 text-gray-700 hover:bg-gray-50 transition-colors rounded-lg mx-2">
                                {% trans 'FAQs' %}
                            </a>
                        </div>
                    </li>

                    {# Blog #}
                    <li>
                        <a href="{% url 'wagtail_serve' '' %}"
                           class="px-4 py-2 rounded-lg font-medium transition-all duration-200 {% if transparent %}text-white hover:bg-white/10{% else %}text-gray-700 hover:bg-gray-100{% endif %}"
                           :class="{ 'text-gray-700 hover:bg-gray-100': scrolled }">
                            {% trans 'Blog' %}
                        </a>
                    </li>
                </ul>
            </nav>

            {# ========== RIGHT SIDE (Language + Auth) ========== #}
            <div class="flex items-center gap-3">

                {# Language Selector #}
                <form action="{% url 'set_language' %}" method="post" class="hidden sm:block">
                    {% csrf_token %}
                    <select name="language"
                            onchange="this.form.submit()"
                            class="px-3 py-2 rounded-lg border transition-all duration-200 cursor-pointer focus:outline-none focus:ring-2 focus:ring-primary {% if transparent %}bg-transparent text-white border-white/30{% else %}bg-white text-gray-700 border-gray-300{% endif %}"
                            :class="{ 'bg-white text-gray-700 border-gray-300': scrolled }">
                        {% get_current_language as LANGUAGE_CODE %}
                        {% get_available_languages as LANGUAGES %}
                        {% for lang_code, lang_name in LANGUAGES %}
                        <option value="{{ lang_code }}" {% if lang_code == LANGUAGE_CODE %}selected{% endif %} class="text-gray-700 bg-white">
                            {{ lang_name }}
                        </option>
                        {% endfor %}
                    </select>
                    <input type="hidden" name="next" value="{{ request.path }}">
                </form>

                {# Auth Buttons #}
                <div class="hidden lg:flex items-center gap-2">
                    {% if user.is_authenticated %}
                        <a href="{% url 'dashboard:index' %}"
                           class="flex items-center gap-2 px-4 py-2 rounded-lg border transition-all duration-200 {% if transparent %}text-white border-white/30 hover:bg-white hover:text-gray-900{% else %}text-gray-700 border-gray-300 hover:bg-gray-100{% endif %}"
                           :class="{ 'text-gray-700 border-gray-300 hover:bg-gray-100': scrolled }">
                            <span class="ph-bold ph-squares-four text-lg"></span>
                            <span>{% trans 'Dashboard' %}</span>
                        </a>
                        <a href="{% url 'account_logout' %}"
                           class="flex items-center gap-2 px-4 py-2 rounded-lg bg-primary text-white hover:bg-primary/90 transition-all duration-200">
                            <span class="ph-bold ph-sign-out text-lg"></span>
                            <span>{% trans 'Sign Out' %}</span>
                        </a>
                    {% else %}
                        <a href="{% url 'account_login' %}"
                           class="px-4 py-2 rounded-lg font-medium transition-all duration-200 {% if transparent %}text-white hover:bg-white/10{% else %}text-gray-700 hover:bg-gray-100{% endif %}"
                           :class="{ 'text-gray-700 hover:bg-gray-100': scrolled }">
                            {% trans 'Sign In' %}
                        </a>
                        <a href="{% url 'account_signup' %}"
                           class="flex items-center gap-2 px-5 py-2.5 rounded-lg bg-primary text-white hover:bg-primary/90 transition-all duration-200 font-medium">
                            <span>{% trans 'Get Started' %}</span>
                            <span class="ph-bold ph-arrow-right"></span>
                        </a>
                    {% endif %}
                </div>

                {# Mobile Menu Toggle #}
                <button @click="mobileMenuOpen = !mobileMenuOpen"
                        type="button"
                        class="lg:hidden p-2 rounded-lg transition-colors {% if transparent %}text-white hover:bg-white/10{% else %}text-gray-700 hover:bg-gray-100{% endif %}"
                        :class="{ 'text-gray-700 hover:bg-gray-100': scrolled }"
                        aria-label="Toggle menu"
                        aria-expanded="false">
                    <span class="ph-bold ph-list text-2xl" x-show="!mobileMenuOpen"></span>
                    <span class="ph-bold ph-x text-2xl" x-show="mobileMenuOpen" x-cloak></span>
                </button>
            </div>
        </div>
    </div>

    {# ========== MOBILE MENU ========== #}
    <div x-show="mobileMenuOpen"
         x-transition:enter="transition ease-out duration-200"
         x-transition:enter-start="opacity-0 -translate-y-2"
         x-transition:enter-end="opacity-100 translate-y-0"
         x-transition:leave="transition ease-in duration-150"
         x-transition:leave-start="opacity-100 translate-y-0"
         x-transition:leave-end="opacity-0 -translate-y-2"
         @click.outside="mobileMenuOpen = false"
         class="lg:hidden border-t border-gray-200 bg-white shadow-lg"
         style="display: none;"
         x-cloak>
        <nav class="container mx-auto px-4 py-6">
            <ul class="space-y-2">

                {# Home #}
                <li>
                    <a href="{% url 'home' %}"
                       class="flex items-center gap-3 px-4 py-3 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors"
                       @click="mobileMenuOpen = false">
                        <span class="ph-bold ph-house text-xl"></span>
                        <span class="font-medium">{% trans 'Home' %}</span>
                    </a>
                </li>

                {# Find Work #}
                <li x-data="{ expanded: false }">
                    <button @click="expanded = !expanded"
                            class="flex items-center justify-between w-full px-4 py-3 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors">
                        <div class="flex items-center gap-3">
                            <span class="ph-bold ph-briefcase text-xl"></span>
                            <span class="font-medium">{% trans 'Find Work' %}</span>
                        </div>
                        <span class="ph-bold ph-caret-down transition-transform" :class="{ 'rotate-180': expanded }"></span>
                    </button>
                    <ul x-show="expanded" x-collapse class="mt-2 ml-10 space-y-1">
                        <li>
                            <a href="{% url 'careers:job_list' %}"
                               class="block px-4 py-2 text-gray-600 hover:text-primary transition-colors"
                               @click="mobileMenuOpen = false">
                                {% trans 'Browse Jobs' %}
                            </a>
                        </li>
                        <li>
                            <a href="{% url 'become_seller' %}"
                               class="block px-4 py-2 text-gray-600 hover:text-primary transition-colors"
                               @click="mobileMenuOpen = false">
                                {% trans 'Become a Freelancer' %}
                            </a>
                        </li>
                    </ul>
                </li>

                {# Find Talent #}
                <li x-data="{ expanded: false }">
                    <button @click="expanded = !expanded"
                            class="flex items-center justify-between w-full px-4 py-3 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors">
                        <div class="flex items-center gap-3">
                            <span class="ph-bold ph-users-three text-xl"></span>
                            <span class="font-medium">{% trans 'Find Talent' %}</span>
                        </div>
                        <span class="ph-bold ph-caret-down transition-transform" :class="{ 'rotate-180': expanded }"></span>
                    </button>
                    <ul x-show="expanded" x-collapse class="mt-2 ml-10 space-y-1">
                        <li>
                            <a href="{% url 'services:service_list' %}"
                               class="block px-4 py-2 text-gray-600 hover:text-primary transition-colors"
                               @click="mobileMenuOpen = false">
                                {% trans 'Browse Services' %}
                            </a>
                        </li>
                        <li>
                            <a href="{% url 'become_buyer' %}"
                               class="block px-4 py-2 text-gray-600 hover:text-primary transition-colors"
                               @click="mobileMenuOpen = false">
                                {% trans 'Hire Talent' %}
                            </a>
                        </li>
                    </ul>
                </li>

                {# Company #}
                <li x-data="{ expanded: false }">
                    <button @click="expanded = !expanded"
                            class="flex items-center justify-between w-full px-4 py-3 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors">
                        <div class="flex items-center gap-3">
                            <span class="ph-bold ph-buildings text-xl"></span>
                            <span class="font-medium">{% trans 'Company' %}</span>
                        </div>
                        <span class="ph-bold ph-caret-down transition-transform" :class="{ 'rotate-180': expanded }"></span>
                    </button>
                    <ul x-show="expanded" x-collapse class="mt-2 ml-10 space-y-1">
                        <li>
                            <a href="{% url 'about' %}"
                               class="block px-4 py-2 text-gray-600 hover:text-primary transition-colors"
                               @click="mobileMenuOpen = false">
                                {% trans 'About Us' %}
                            </a>
                        </li>
                        <li>
                            <a href="{% url 'pricing' %}"
                               class="block px-4 py-2 text-gray-600 hover:text-primary transition-colors"
                               @click="mobileMenuOpen = false">
                                {% trans 'Pricing' %}
                            </a>
                        </li>
                        <li>
                            <a href="{% url 'contact_us' %}"
                               class="block px-4 py-2 text-gray-600 hover:text-primary transition-colors"
                               @click="mobileMenuOpen = false">
                                {% trans 'Contact Us' %}
                            </a>
                        </li>
                        <li>
                            <a href="{% url 'faq' %}"
                               class="block px-4 py-2 text-gray-600 hover:text-primary transition-colors"
                               @click="mobileMenuOpen = false">
                                {% trans 'FAQs' %}
                            </a>
                        </li>
                    </ul>
                </li>

                {# Blog #}
                <li>
                    <a href="{% url 'wagtail_serve' '' %}"
                       class="flex items-center gap-3 px-4 py-3 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors"
                       @click="mobileMenuOpen = false">
                        <span class="ph-bold ph-article text-xl"></span>
                        <span class="font-medium">{% trans 'Blog' %}</span>
                    </a>
                </li>
            </ul>

            {# Mobile Language Selector #}
            <div class="mt-6 pt-6 border-t border-gray-200">
                <form action="{% url 'set_language' %}" method="post">
                    {% csrf_token %}
                    <label class="block text-sm font-medium text-gray-700 mb-2">{% trans 'Language' %}</label>
                    <select name="language"
                            onchange="this.form.submit()"
                            class="w-full px-4 py-2 rounded-lg border border-gray-300 bg-white text-gray-700 cursor-pointer focus:outline-none focus:ring-2 focus:ring-primary">
                        {% get_current_language as LANGUAGE_CODE %}
                        {% get_available_languages as LANGUAGES %}
                        {% for lang_code, lang_name in LANGUAGES %}
                        <option value="{{ lang_code }}" {% if lang_code == LANGUAGE_CODE %}selected{% endif %}>
                            {{ lang_name }}
                        </option>
                        {% endfor %}
                    </select>
                    <input type="hidden" name="next" value="{{ request.path }}">
                </form>
            </div>

            {# Mobile Auth Buttons #}
            {% if not user.is_authenticated %}
            <div class="mt-6 space-y-3">
                <a href="{% url 'account_login' %}"
                   class="block w-full px-4 py-3 text-center rounded-lg border border-primary text-primary font-medium hover:bg-primary hover:text-white transition-all"
                   @click="mobileMenuOpen = false">
                    {% trans 'Sign In' %}
                </a>
                <a href="{% url 'account_signup' %}"
                   class="block w-full px-4 py-3 text-center rounded-lg bg-primary text-white font-medium hover:bg-primary/90 transition-all"
                   @click="mobileMenuOpen = false">
                    {% trans 'Get Started' %}
                </a>
            </div>
            {% else %}
            <div class="mt-6 space-y-3">
                <a href="{% url 'dashboard:index' %}"
                   class="flex items-center justify-center gap-2 w-full px-4 py-3 rounded-lg border border-gray-300 text-gray-700 font-medium hover:bg-gray-100 transition-all"
                   @click="mobileMenuOpen = false">
                    <span class="ph-bold ph-squares-four text-lg"></span>
                    <span>{% trans 'Dashboard' %}</span>
                </a>
                <a href="{% url 'account_logout' %}"
                   class="flex items-center justify-center gap-2 w-full px-4 py-3 rounded-lg bg-primary text-white font-medium hover:bg-primary/90 transition-all"
                   @click="mobileMenuOpen = false">
                    <span class="ph-bold ph-sign-out text-lg"></span>
                    <span>{% trans 'Sign Out' %}</span>
                </a>
            </div>
            {% endif %}
        </nav>
    </div>
</header>
