{% comment %}
=============================================================================
   ZUMODRA PUBLIC HEADER - UNIVERSAL NAVIGATION
=============================================================================

   Clear, semantic navigation structure for all users:
   - Browse (find what you need: services or jobs)
   - Solutions (understand what Zumodra offers you)
   - Company (learn about us)

   NO role-specific language - works for everyone

   Author: Rhematek Solutions
   Last Updated: 2026-01-10
=============================================================================
{% endcomment %}

{% load i18n static %}

<header id="header" class="header sticky top-0 z-50 {% if transparent %}bg-transparent{% else %}bg-white shadow-sm{% endif %} transition-all duration-300"
        x-data="{ mobileMenuOpen: false, scrolled: false }"
        x-init="window.addEventListener('scroll', () => { scrolled = window.scrollY > 50 })"
        :class="{ 'bg-white shadow-md': scrolled || !{{ transparent|default:'false' }} }">

    <div class="container mx-auto">
        <div class="flex items-center justify-between h-20 px-4">

            {% comment %} ========== LOGO ========== {% endcomment %}
            <div class="flex items-center">
                <a href="{% url 'home' %}" class="flex items-center" aria-label="Zumodra Home">
                    {% comment %} Single logo that works in all states {% endcomment %}
                    <img src="{% static 'assets/images/rhematekC.png' %}"
                         alt="Zumodra"
                         class="h-10 w-auto" />
                </a>
            </div>

            {% comment %} ========== DESKTOP NAVIGATION ========== {% endcomment %}
            <nav class="hidden lg:flex items-center gap-1" aria-label="Main navigation">
                <ul class="flex items-center gap-1">

                    {% comment %} Home {% endcomment %}
                    <li>
                        <a href="{% url 'home' %}"
                           class="px-4 py-2 rounded-lg font-medium transition-all duration-200 {% if transparent %}text-white hover:bg-white/10{% else %}text-gray-700 hover:bg-gray-100{% endif %}"
                           :class="{ 'text-gray-700 hover:bg-gray-100': scrolled }">
                            {% trans 'Home' %}
                        </a>
                    </li>

                    {% comment %} Browse - What you can find/search {% endcomment %}
                    <li class="relative" x-data="{ open: false }" @mouseenter="open = true" @mouseleave="open = false">
                        <button class="px-4 py-2 rounded-lg font-medium transition-all duration-200 flex items-center gap-1 {% if transparent %}text-white hover:bg-white/10{% else %}text-gray-700 hover:bg-gray-100{% endif %}"
                                :class="{ 'text-gray-700 hover:bg-gray-100': scrolled }"
                                aria-expanded="false"
                                @click="open = !open">
                            {% trans 'Browse' %}
                            <span class="ph-bold ph-caret-down text-xs transition-transform duration-200" :class="{ 'rotate-180': open }"></span>
                        </button>
                        <div x-show="open"
                             x-cloak
                             x-transition:enter="transition ease-out duration-200"
                             x-transition:enter-start="opacity-0 scale-95"
                             x-transition:enter-end="opacity-100 scale-100"
                             x-transition:leave="transition ease-in duration-150"
                             x-transition:leave-start="opacity-100 scale-100"
                             x-transition:leave-end="opacity-0 scale-95"
                             @click.outside="open = false"
                             class="absolute top-full left-0 mt-2 w-64 bg-white rounded-xl shadow-lg border border-gray-200 py-2 z-[100]">
                            <a href="{% url 'services:service_list' %}"
                               class="flex items-center gap-3 px-4 py-3 text-gray-700 hover:bg-gray-50 transition-colors">
                                <span class="ph-bold ph-storefront text-xl text-primary"></span>
                                <div>
                                    <div class="font-medium">{% trans 'Services' %}</div>
                                    <div class="text-xs text-gray-500">{% trans 'Find professional services' %}</div>
                                </div>
                            </a>
                            <a href="{% url 'careers:job_list' %}"
                               class="flex items-center gap-3 px-4 py-3 text-gray-700 hover:bg-gray-50 transition-colors">
                                <span class="ph-bold ph-briefcase text-xl text-primary"></span>
                                <div>
                                    <div class="font-medium">{% trans 'Jobs' %}</div>
                                    <div class="text-xs text-gray-500">{% trans 'Discover opportunities' %}</div>
                                </div>
                            </a>
                            <a href="{% url 'careers:browse_companies' %}"
                               class="flex items-center gap-3 px-4 py-3 text-gray-700 hover:bg-gray-50 transition-colors">
                                <span class="ph-bold ph-buildings text-xl text-primary"></span>
                                <div>
                                    <div class="font-medium">{% trans 'Companies' %}</div>
                                    <div class="text-xs text-gray-500">{% trans 'Browse companies hiring' %}</div>
                                </div>
                            </a>
                        </div>
                    </li>

                    {% comment %} Solutions - What Zumodra offers {% endcomment %}
                    <li class="relative" x-data="{ open: false }" @mouseenter="open = true" @mouseleave="open = false">
                        <button class="px-4 py-2 rounded-lg font-medium transition-all duration-200 flex items-center gap-1 {% if transparent %}text-white hover:bg-white/10{% else %}text-gray-700 hover:bg-gray-100{% endif %}"
                                :class="{ 'text-gray-700 hover:bg-gray-100': scrolled }"
                                aria-expanded="false"
                                @click="open = !open">
                            {% trans 'Solutions' %}
                            <span class="ph-bold ph-caret-down text-xs transition-transform duration-200" :class="{ 'rotate-180': open }"></span>
                        </button>
                        <div x-show="open"
                             x-cloak
                             x-transition:enter="transition ease-out duration-200"
                             x-transition:enter-start="opacity-0 scale-95"
                             x-transition:enter-end="opacity-100 scale-100"
                             x-transition:leave="transition ease-in duration-150"
                             x-transition:leave-start="opacity-100 scale-100"
                             x-transition:leave-end="opacity-0 scale-95"
                             @click.outside="open = false"
                             class="absolute top-full left-0 mt-2 w-72 bg-white rounded-xl shadow-lg border border-gray-200 py-2 z-[100]">
                            <a href="{% url 'become_buyer' %}"
                               class="flex items-center gap-3 px-4 py-3 text-gray-700 hover:bg-gray-50 transition-colors">
                                <span class="ph-bold ph-buildings text-xl text-primary"></span>
                                <div>
                                    <div class="font-medium">{% trans 'For Businesses' %}</div>
                                    <div class="text-xs text-gray-500">{% trans 'Hire talent & manage your team' %}</div>
                                </div>
                            </a>
                            <a href="{% url 'become_seller' %}"
                               class="flex items-center gap-3 px-4 py-3 text-gray-700 hover:bg-gray-50 transition-colors">
                                <span class="ph-bold ph-user-circle text-xl text-primary"></span>
                                <div>
                                    <div class="font-medium">{% trans 'For Professionals' %}</div>
                                    <div class="text-xs text-gray-500">{% trans 'Grow your career & business' %}</div>
                                </div>
                            </a>
                        </div>
                    </li>

                    {% comment %} Company {% endcomment %}
                    <li class="relative" x-data="{ open: false }" @mouseenter="open = true" @mouseleave="open = false">
                        <button class="px-4 py-2 rounded-lg font-medium transition-all duration-200 flex items-center gap-1 {% if transparent %}text-white hover:bg-white/10{% else %}text-gray-700 hover:bg-gray-100{% endif %}"
                                :class="{ 'text-gray-700 hover:bg-gray-100': scrolled }"
                                aria-expanded="false"
                                @click="open = !open">
                            {% trans 'Company' %}
                            <span class="ph-bold ph-caret-down text-xs transition-transform duration-200" :class="{ 'rotate-180': open }"></span>
                        </button>
                        <div x-show="open"
                             x-cloak
                             x-transition:enter="transition ease-out duration-200"
                             x-transition:enter-start="opacity-0 scale-95"
                             x-transition:enter-end="opacity-100 scale-100"
                             x-transition:leave="transition ease-in duration-150"
                             x-transition:leave-start="opacity-100 scale-100"
                             x-transition:leave-end="opacity-0 scale-95"
                             @click.outside="open = false"
                             class="absolute top-full left-0 mt-2 w-56 bg-white rounded-xl shadow-lg border border-gray-200 py-2 z-[100]">
                            <a href="{% url 'about' %}" class="block px-4 py-2.5 text-gray-700 hover:bg-gray-50 transition-colors rounded-lg mx-2">
                                {% trans 'About Us' %}
                            </a>
                            <a href="{% url 'pricing' %}" class="block px-4 py-2.5 text-gray-700 hover:bg-gray-50 transition-colors rounded-lg mx-2">
                                {% trans 'Pricing' %}
                            </a>
                            <a href="{% url 'contact_us' %}" class="block px-4 py-2.5 text-gray-700 hover:bg-gray-50 transition-colors rounded-lg mx-2">
                                {% trans 'Contact Us' %}
                            </a>
                            <hr class="my-2 border-gray-100">
                            <a href="{% url 'faq' %}" class="block px-4 py-2.5 text-gray-700 hover:bg-gray-50 transition-colors rounded-lg mx-2">
                                {% trans 'FAQs' %}
                            </a>
                        </div>
                    </li>

                    {% comment %} Blog {% endcomment %}
                    <li>
                        <a href="{% url 'wagtail_serve' '' %}"
                           class="px-4 py-2 rounded-lg font-medium transition-all duration-200 {% if transparent %}text-white hover:bg-white/10{% else %}text-gray-700 hover:bg-gray-100{% endif %}"
                           :class="{ 'text-gray-700 hover:bg-gray-100': scrolled }">
                            {% trans 'Blog' %}
                        </a>
                    </li>
                </ul>
            </nav>

            {% comment %} ========== RIGHT SIDE (Dark Mode + Language + Auth) ========== {% endcomment %}
            <div class="flex items-center gap-3">

                {% comment %} Dark Mode Toggle {% endcomment %}
                <button type="button"
                        onclick="document.documentElement.classList.toggle('dark'); localStorage.setItem('theme', document.documentElement.classList.contains('dark') ? 'dark' : 'light');"
                        class="p-2 rounded-lg transition-colors text-gray-600 hover:text-gray-900 hover:bg-gray-100 dark:text-gray-300 dark:hover:text-white dark:hover:bg-gray-700"
                        aria-label="Toggle dark mode">
                    {% comment %} Sun icon (shown in dark mode) {% endcomment %}
                    <svg class="w-5 h-5 hidden dark:block" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95l.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707a1 1 0 11-1.414-1.414l.707-.707a1 1 0 011.414 0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707a1 1 0 00-1.414 1.414l.707.707zm1.414 8.486l-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z" clip-rule="evenodd"/>
                    </svg>
                    {% comment %} Moon icon (shown in light mode) {% endcomment %}
                    <svg class="w-5 h-5 block dark:hidden" fill="currentColor" viewBox="0 0 20 20">
                        <path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"/>
                    </svg>
                </button>

                {% comment %} Language Selector {% endcomment %}
                <form action="{% url 'set_language' %}" method="post" class="hidden sm:block">
                    {% csrf_token %}
                    <select name="language"
                            onchange="this.form.submit()"
                            class="px-3 py-2 rounded-lg border transition-all duration-200 cursor-pointer focus:outline-none focus:ring-2 focus:ring-primary {% if transparent %}bg-transparent text-white border-white/30{% else %}bg-white text-gray-700 border-gray-300{% endif %}"
                            :class="{ 'bg-white text-gray-700 border-gray-300': scrolled }">
                        {% get_current_language as LANGUAGE_CODE %}
                        {% get_available_languages as LANGUAGES %}
                        {% for lang_code, lang_name in LANGUAGES %}
                        <option value="{{ lang_code }}" {% if lang_code == LANGUAGE_CODE %}selected{% endif %} class="text-gray-700 bg-white">
                            {{ lang_name }}
                        </option>
                        {% endfor %}
                    </select>
                    <input type="hidden" name="next" value="{{ request.path }}">
                </form>

                {% comment %} Auth Buttons {% endcomment %}
                <div class="hidden lg:flex items-center gap-2">
                    {% if user.is_authenticated %}
                        <a href="{% url 'frontend:dashboard:index' %}"
                           class="flex items-center gap-2 px-4 py-2 rounded-lg border transition-all duration-200 {% if transparent %}text-white border-white/30 hover:bg-white hover:text-gray-900{% else %}text-gray-700 border-gray-300 hover:bg-gray-100{% endif %}"
                           :class="{ 'text-gray-700 border-gray-300 hover:bg-gray-100': scrolled }">
                            <span class="ph-bold ph-squares-four text-lg"></span>
                            <span>{% trans 'Dashboard' %}</span>
                        </a>
                        <a href="{% url 'account_logout' %}"
                           class="flex items-center gap-2 px-4 py-2 rounded-lg bg-primary text-white hover:bg-primary/90 transition-all duration-200">
                            <span class="ph-bold ph-sign-out text-lg"></span>
                            <span>{% trans 'Sign Out' %}</span>
                        </a>
                    {% else %}
                        <a href="{% url 'account_login' %}"
                           class="px-4 py-2 rounded-lg font-medium transition-all duration-200 {% if transparent %}text-white hover:bg-white/10{% else %}text-gray-700 hover:bg-gray-100{% endif %}"
                           :class="{ 'text-gray-700 hover:bg-gray-100': scrolled }">
                            {% trans 'Sign In' %}
                        </a>
                        <a href="{% url 'account_signup' %}"
                           class="flex items-center gap-2 px-5 py-2.5 rounded-lg bg-primary text-white hover:bg-primary/90 transition-all duration-200 font-medium">
                            <span>{% trans 'Get Started' %}</span>
                            <span class="ph-bold ph-arrow-right"></span>
                        </a>
                    {% endif %}
                </div>

                {% comment %} Mobile Menu Toggle {% endcomment %}
                <button @click="mobileMenuOpen = !mobileMenuOpen"
                        type="button"
                        class="lg:hidden p-2 rounded-lg transition-colors {% if transparent %}text-white hover:bg-white/10{% else %}text-gray-700 hover:bg-gray-100{% endif %}"
                        :class="{ 'text-gray-700 hover:bg-gray-100': scrolled }"
                        aria-label="Toggle menu"
                        aria-expanded="false">
                    <span class="ph-bold ph-list text-2xl" x-show="!mobileMenuOpen"></span>
                    <span class="ph-bold ph-x text-2xl" x-show="mobileMenuOpen" x-cloak></span>
                </button>
            </div>
        </div>
    </div>

    {% comment %} ========== MOBILE MENU ========== {% endcomment %}
    <div x-show="mobileMenuOpen"
         x-transition:enter="transition ease-out duration-200"
         x-transition:enter-start="opacity-0 -translate-y-2"
         x-transition:enter-end="opacity-100 translate-y-0"
         x-transition:leave="transition ease-in duration-150"
         x-transition:leave-start="opacity-100 translate-y-0"
         x-transition:leave-end="opacity-0 -translate-y-2"
         @click.outside="mobileMenuOpen = false"
         class="lg:hidden border-t border-gray-200 bg-white shadow-lg"
         style="display: none;"
         x-cloak>
        <nav class="container mx-auto px-4 py-6">
            <ul class="space-y-2">

                {% comment %} Home {% endcomment %}
                <li>
                    <a href="{% url 'home' %}"
                       class="flex items-center gap-3 px-4 py-3 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors"
                       @click="mobileMenuOpen = false">
                        <span class="ph-bold ph-house text-xl"></span>
                        <span class="font-medium">{% trans 'Home' %}</span>
                    </a>
                </li>

                {% comment %} Browse {% endcomment %}
                <li x-data="{ expanded: false }">
                    <button @click="expanded = !expanded"
                            class="flex items-center justify-between w-full px-4 py-3 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors">
                        <div class="flex items-center gap-3">
                            <span class="ph-bold ph-magnifying-glass text-xl"></span>
                            <span class="font-medium">{% trans 'Browse' %}</span>
                        </div>
                        <span class="ph-bold ph-caret-down transition-transform" :class="{ 'rotate-180': expanded }"></span>
                    </button>
                    <ul x-show="expanded" x-collapse class="mt-2 ml-10 space-y-1">
                        <li>
                            <a href="{% url 'services:service_list' %}"
                               class="block px-4 py-2 text-gray-600 hover:text-primary transition-colors"
                               @click="mobileMenuOpen = false">
                                {% trans 'Services' %}
                            </a>
                        </li>
                        <li>
                            <a href="{% url 'careers:job_list' %}"
                               class="block px-4 py-2 text-gray-600 hover:text-primary transition-colors"
                               @click="mobileMenuOpen = false">
                                {% trans 'Jobs' %}
                            </a>
                        </li>
                        <li>
                            <a href="{% url 'careers:browse_companies' %}"
                               class="block px-4 py-2 text-gray-600 hover:text-primary transition-colors"
                               @click="mobileMenuOpen = false">
                                {% trans 'Companies' %}
                            </a>
                        </li>
                    </ul>
                </li>

                {% comment %} Solutions {% endcomment %}
                <li x-data="{ expanded: false }">
                    <button @click="expanded = !expanded"
                            class="flex items-center justify-between w-full px-4 py-3 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors">
                        <div class="flex items-center gap-3">
                            <span class="ph-bold ph-lightbulb text-xl"></span>
                            <span class="font-medium">{% trans 'Solutions' %}</span>
                        </div>
                        <span class="ph-bold ph-caret-down transition-transform" :class="{ 'rotate-180': expanded }"></span>
                    </button>
                    <ul x-show="expanded" x-collapse class="mt-2 ml-10 space-y-1">
                        <li>
                            <a href="{% url 'become_buyer' %}"
                               class="block px-4 py-2 text-gray-600 hover:text-primary transition-colors"
                               @click="mobileMenuOpen = false">
                                {% trans 'For Businesses' %}
                            </a>
                        </li>
                        <li>
                            <a href="{% url 'become_seller' %}"
                               class="block px-4 py-2 text-gray-600 hover:text-primary transition-colors"
                               @click="mobileMenuOpen = false">
                                {% trans 'For Professionals' %}
                            </a>
                        </li>
                    </ul>
                </li>

                {% comment %} Company {% endcomment %}
                <li x-data="{ expanded: false }">
                    <button @click="expanded = !expanded"
                            class="flex items-center justify-between w-full px-4 py-3 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors">
                        <div class="flex items-center gap-3">
                            <span class="ph-bold ph-buildings text-xl"></span>
                            <span class="font-medium">{% trans 'Company' %}</span>
                        </div>
                        <span class="ph-bold ph-caret-down transition-transform" :class="{ 'rotate-180': expanded }"></span>
                    </button>
                    <ul x-show="expanded" x-collapse class="mt-2 ml-10 space-y-1">
                        <li>
                            <a href="{% url 'about' %}"
                               class="block px-4 py-2 text-gray-600 hover:text-primary transition-colors"
                               @click="mobileMenuOpen = false">
                                {% trans 'About Us' %}
                            </a>
                        </li>
                        <li>
                            <a href="{% url 'pricing' %}"
                               class="block px-4 py-2 text-gray-600 hover:text-primary transition-colors"
                               @click="mobileMenuOpen = false">
                                {% trans 'Pricing' %}
                            </a>
                        </li>
                        <li>
                            <a href="{% url 'contact_us' %}"
                               class="block px-4 py-2 text-gray-600 hover:text-primary transition-colors"
                               @click="mobileMenuOpen = false">
                                {% trans 'Contact Us' %}
                            </a>
                        </li>
                        <li>
                            <a href="{% url 'faq' %}"
                               class="block px-4 py-2 text-gray-600 hover:text-primary transition-colors"
                               @click="mobileMenuOpen = false">
                                {% trans 'FAQs' %}
                            </a>
                        </li>
                    </ul>
                </li>

                {% comment %} Blog {% endcomment %}
                <li>
                    <a href="{% url 'wagtail_serve' '' %}"
                       class="flex items-center gap-3 px-4 py-3 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors"
                       @click="mobileMenuOpen = false">
                        <span class="ph-bold ph-article text-xl"></span>
                        <span class="font-medium">{% trans 'Blog' %}</span>
                    </a>
                </li>
            </ul>

            {% comment %} Mobile Language Selector {% endcomment %}
            <div class="mt-6 pt-6 border-t border-gray-200">
                <form action="{% url 'set_language' %}" method="post">
                    {% csrf_token %}
                    <label class="block text-sm font-medium text-gray-700 mb-2">{% trans 'Language' %}</label>
                    <select name="language"
                            onchange="this.form.submit()"
                            class="w-full px-4 py-2 rounded-lg border border-gray-300 bg-white text-gray-700 cursor-pointer focus:outline-none focus:ring-2 focus:ring-primary">
                        {% get_current_language as LANGUAGE_CODE %}
                        {% get_available_languages as LANGUAGES %}
                        {% for lang_code, lang_name in LANGUAGES %}
                        <option value="{{ lang_code }}" {% if lang_code == LANGUAGE_CODE %}selected{% endif %}>
                            {{ lang_name }}
                        </option>
                        {% endfor %}
                    </select>
                    <input type="hidden" name="next" value="{{ request.path }}">
                </form>
            </div>

            {% comment %} Mobile Auth Buttons {% endcomment %}
            {% if not user.is_authenticated %}
            <div class="mt-6 space-y-3">
                <a href="{% url 'account_login' %}"
                   class="block w-full px-4 py-3 text-center rounded-lg border border-primary text-primary font-medium hover:bg-primary hover:text-white transition-all"
                   @click="mobileMenuOpen = false">
                    {% trans 'Sign In' %}
                </a>
                <a href="{% url 'account_signup' %}"
                   class="block w-full px-4 py-3 text-center rounded-lg bg-primary text-white font-medium hover:bg-primary/90 transition-all"
                   @click="mobileMenuOpen = false">
                    {% trans 'Get Started' %}
                </a>
            </div>
            {% else %}
            <div class="mt-6 space-y-3">
                <a href="{% url 'frontend:dashboard:index' %}"
                   class="flex items-center justify-center gap-2 w-full px-4 py-3 rounded-lg border border-gray-300 text-gray-700 font-medium hover:bg-gray-100 transition-all"
                   @click="mobileMenuOpen = false">
                    <span class="ph-bold ph-squares-four text-lg"></span>
                    <span>{% trans 'Dashboard' %}</span>
                </a>
                <a href="{% url 'account_logout' %}"
                   class="flex items-center justify-center gap-2 w-full px-4 py-3 rounded-lg bg-primary text-white font-medium hover:bg-primary/90 transition-all"
                   @click="mobileMenuOpen = false">
                    <span class="ph-bold ph-sign-out text-lg"></span>
                    <span>{% trans 'Sign Out' %}</span>
                </a>
            </div>
            {% endif %}
        </nav>
    </div>
</header>
