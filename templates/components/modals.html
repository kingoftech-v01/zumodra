{% comment %}
================================================================================
ZUMODRA MODAL COMPONENT TEMPLATES
================================================================================
Usage: {% include "components/modals.html" with variant="default" id="my-modal" title="Modal Title" %}

Available variants: default, confirm, alert, form, fullscreen, drawer, media
Sizes: sm, md (default), lg, xl, full

Design System: Uses zu-* prefixed classes from zumodra-design-system.css
{% endcomment %}

{% comment %}
==============================================================================
DEFAULT MODAL
Usage: {% include "components/modals.html" with variant="default" id="modal-example" title="Modal Title" %}
==============================================================================
{% endcomment %}

{% if variant == "default" %}
<div
    class="zu-modal-backdrop{% if active %} active{% endif %}"
    id="{{ id }}"
    role="dialog"
    aria-modal="true"
    aria-labelledby="{{ id }}-title"
    {% if aria_describedby %}aria-describedby="{{ aria_describedby }}"{% endif %}
    x-data="{ open: {{ active|yesno:'true,false' }} }"
    x-show="open"
    x-transition:enter="transition ease-out duration-200"
    x-transition:enter-start="opacity-0"
    x-transition:enter-end="opacity-100"
    x-transition:leave="transition ease-in duration-150"
    x-transition:leave-start="opacity-100"
    x-transition:leave-end="opacity-0"
    @click.self="open = false"
    @keydown.escape.window="open = false"
    x-cloak
>
    <div class="zu-modal{% if size %} zu-modal--{{ size }}{% endif %}{% if extra_class %} {{ extra_class }}{% endif %}"
         x-show="open"
         x-transition:enter="transition ease-out duration-200"
         x-transition:enter-start="opacity-0 scale-95 translate-y-4"
         x-transition:enter-end="opacity-100 scale-100 translate-y-0"
         x-transition:leave="transition ease-in duration-150"
         x-transition:leave-start="opacity-100 scale-100"
         x-transition:leave-end="opacity-0 scale-95">
        <div class="zu-modal__header">
            <h2 class="zu-modal__title" id="{{ id }}-title">{{ title }}</h2>
            <button
                type="button"
                class="zu-modal__close"
                aria-label="{% if close_label %}{{ close_label }}{% else %}Close modal{% endif %}"
                @click="open = false"
            >
                <svg class="zu-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
                    <line x1="18" y1="6" x2="6" y2="18"></line>
                    <line x1="6" y1="6" x2="18" y2="18"></line>
                </svg>
            </button>
        </div>

        <div class="zu-modal__body">
            {% if body %}{{ body|safe }}{% endif %}
            {% if content %}{{ content|safe }}{% endif %}
        </div>

        {% if footer %}
        <div class="zu-modal__footer{% if footer_split %} zu-modal__footer--split{% endif %}">
            {{ footer|safe }}
        </div>
        {% elif show_default_footer %}
        <div class="zu-modal__footer">
            <button type="button" class="zu-btn zu-btn--secondary" @click="open = false">Cancel</button>
            <button type="button" class="zu-btn zu-btn--primary" data-modal-confirm="{{ id }}">Confirm</button>
        </div>
        {% endif %}
    </div>
</div>
{% endif %}

{% comment %}
==============================================================================
CONFIRM MODAL (for confirmations/destructive actions)
Usage: {% include "components/modals.html" with variant="confirm" id="confirm-delete" title="Delete Item?" message="This action cannot be undone." confirm_text="Delete" confirm_style="danger" %}
==============================================================================
{% endcomment %}

{% if variant == "confirm" %}
<div
    class="zu-modal-backdrop{% if active %} active{% endif %}"
    id="{{ id }}"
    role="alertdialog"
    aria-modal="true"
    aria-labelledby="{{ id }}-title"
    aria-describedby="{{ id }}-desc"
    x-data="{ open: {{ active|yesno:'true,false' }} }"
    x-show="open"
    x-transition:enter="transition ease-out duration-200"
    x-transition:enter-start="opacity-0"
    x-transition:enter-end="opacity-100"
    x-transition:leave="transition ease-in duration-150"
    x-transition:leave-start="opacity-100"
    x-transition:leave-end="opacity-0"
    @click.self="open = false"
    @keydown.escape.window="open = false"
    x-cloak
>
    <div class="zu-modal zu-modal--sm{% if extra_class %} {{ extra_class }}{% endif %}"
         x-show="open"
         x-transition:enter="transition ease-out duration-200"
         x-transition:enter-start="opacity-0 scale-95"
         x-transition:enter-end="opacity-100 scale-100"
         x-transition:leave="transition ease-in duration-150"
         x-transition:leave-start="opacity-100 scale-100"
         x-transition:leave-end="opacity-0 scale-95">
        <div class="zu-modal__header">
            <h2 class="zu-modal__title" id="{{ id }}-title">{{ title }}</h2>
            <button type="button" class="zu-modal__close" aria-label="Close" @click="open = false">
                <svg class="zu-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                    <line x1="18" y1="6" x2="6" y2="18"></line>
                    <line x1="6" y1="6" x2="18" y2="18"></line>
                </svg>
            </button>
        </div>

        <div class="zu-modal__body zu-text-center">
            {% if icon %}
            <div class="zu-flex zu-justify-center" style="margin-bottom: var(--zu-space-4);">
                <div class="zu-modal__icon zu-modal__icon--{{ icon_color|default:'warning' }}">
                    <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
                        {{ icon|safe }}
                    </svg>
                </div>
            </div>
            {% endif %}
            <p id="{{ id }}-desc" style="color: var(--zu-text-secondary); margin: 0;">
                {{ message }}
            </p>
        </div>

        <div class="zu-modal__footer zu-justify-center">
            <button type="button" class="zu-btn zu-btn--secondary" @click="open = false">
                {{ cancel_text|default:"Cancel" }}
            </button>
            <button type="button" class="zu-btn zu-btn--{{ confirm_style|default:'primary' }}" data-modal-confirm="{{ id }}">
                {{ confirm_text|default:"Confirm" }}
            </button>
        </div>
    </div>
</div>
{% endif %}

{% comment %}
==============================================================================
ALERT MODAL (for notifications/information)
Usage: {% include "components/modals.html" with variant="alert" id="alert-success" title="Success!" message="Your changes have been saved." alert_type="success" %}
==============================================================================
{% endcomment %}

{% if variant == "alert" %}
<div
    class="zu-modal-backdrop{% if active %} active{% endif %}"
    id="{{ id }}"
    role="alertdialog"
    aria-modal="true"
    aria-labelledby="{{ id }}-title"
    aria-describedby="{{ id }}-desc"
    x-data="{ open: {{ active|yesno:'true,false' }} }"
    x-show="open"
    x-transition:enter="transition ease-out duration-200"
    x-transition:enter-start="opacity-0"
    x-transition:enter-end="opacity-100"
    x-transition:leave="transition ease-in duration-150"
    x-transition:leave-start="opacity-100"
    x-transition:leave-end="opacity-0"
    @click.self="open = false"
    @keydown.escape.window="open = false"
    x-cloak
>
    <div class="zu-modal zu-modal--sm{% if extra_class %} {{ extra_class }}{% endif %}"
         x-show="open"
         x-transition:enter="transition ease-out duration-200"
         x-transition:enter-start="opacity-0 scale-95"
         x-transition:enter-end="opacity-100 scale-100"
         x-transition:leave="transition ease-in duration-150"
         x-transition:leave-start="opacity-100 scale-100"
         x-transition:leave-end="opacity-0 scale-95">
        <div class="zu-modal__body zu-text-center" style="padding: var(--zu-space-8);">
            {% if alert_type == "success" %}
            <div class="zu-modal__icon zu-modal__icon--success">
                <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
                    <polyline points="20 6 9 17 4 12"></polyline>
                </svg>
            </div>
            {% elif alert_type == "error" %}
            <div class="zu-modal__icon zu-modal__icon--error">
                <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
                    <circle cx="12" cy="12" r="10"></circle>
                    <line x1="15" y1="9" x2="9" y2="15"></line>
                    <line x1="9" y1="9" x2="15" y2="15"></line>
                </svg>
            </div>
            {% elif alert_type == "warning" %}
            <div class="zu-modal__icon zu-modal__icon--warning">
                <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"></path>
                    <line x1="12" y1="9" x2="12" y2="13"></line>
                    <line x1="12" y1="17" x2="12.01" y2="17"></line>
                </svg>
            </div>
            {% else %}
            <div class="zu-modal__icon zu-modal__icon--info">
                <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
                    <circle cx="12" cy="12" r="10"></circle>
                    <line x1="12" y1="16" x2="12" y2="12"></line>
                    <line x1="12" y1="8" x2="12.01" y2="8"></line>
                </svg>
            </div>
            {% endif %}

            <h2 class="zu-modal__title" id="{{ id }}-title" style="margin-bottom: var(--zu-space-2);">{{ title }}</h2>
            <p id="{{ id }}-desc" style="color: var(--zu-text-secondary); margin: 0;">
                {{ message }}
            </p>
        </div>

        <div class="zu-modal__footer zu-justify-center" style="border-top: none; background: transparent;">
            <button type="button" class="zu-btn zu-btn--primary" @click="open = false">
                {{ button_text|default:"OK" }}
            </button>
        </div>
    </div>
</div>
{% endif %}

{% comment %}
==============================================================================
FORM MODAL (contains a form)
Usage: {% include "components/modals.html" with variant="form" id="form-modal" title="Edit Profile" form_id="edit-profile-form" %}
==============================================================================
{% endcomment %}

{% if variant == "form" %}
<div
    class="zu-modal-backdrop{% if active %} active{% endif %}"
    id="{{ id }}"
    role="dialog"
    aria-modal="true"
    aria-labelledby="{{ id }}-title"
    x-data="{ open: {{ active|yesno:'true,false' }} }"
    x-show="open"
    x-transition:enter="transition ease-out duration-200"
    x-transition:enter-start="opacity-0"
    x-transition:enter-end="opacity-100"
    x-transition:leave="transition ease-in duration-150"
    x-transition:leave-start="opacity-100"
    x-transition:leave-end="opacity-0"
    @click.self="open = false"
    @keydown.escape.window="open = false"
    x-cloak
>
    <div class="zu-modal{% if size %} zu-modal--{{ size }}{% endif %}{% if extra_class %} {{ extra_class }}{% endif %}"
         x-show="open"
         x-transition:enter="transition ease-out duration-200"
         x-transition:enter-start="opacity-0 scale-95"
         x-transition:enter-end="opacity-100 scale-100"
         x-transition:leave="transition ease-in duration-150"
         x-transition:leave-start="opacity-100 scale-100"
         x-transition:leave-end="opacity-0 scale-95">
        <form id="{{ form_id|default:id }}-form" method="{{ form_method|default:'post' }}"{% if form_action %} action="{{ form_action }}"{% endif %}{% if form_enctype %} enctype="{{ form_enctype }}"{% endif %}>
            {% csrf_token %}

            <div class="zu-modal__header">
                <h2 class="zu-modal__title" id="{{ id }}-title">{{ title }}</h2>
                <button type="button" class="zu-modal__close" aria-label="Close" @click="open = false">
                    <svg class="zu-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                        <line x1="18" y1="6" x2="6" y2="18"></line>
                        <line x1="6" y1="6" x2="18" y2="18"></line>
                    </svg>
                </button>
            </div>

            <div class="zu-modal__body">
                {% if body %}{{ body|safe }}{% endif %}
                {% if content %}{{ content|safe }}{% endif %}
                {% if form_fields %}{{ form_fields|safe }}{% endif %}
            </div>

            <div class="zu-modal__footer">
                <button type="button" class="zu-btn zu-btn--secondary" @click="open = false">
                    {{ cancel_text|default:"Cancel" }}
                </button>
                <button type="submit" class="zu-btn zu-btn--primary">
                    {{ submit_text|default:"Save" }}
                </button>
            </div>
        </form>
    </div>
</div>
{% endif %}

{% comment %}
==============================================================================
FULLSCREEN MODAL
Usage: {% include "components/modals.html" with variant="fullscreen" id="fullscreen-modal" title="Full Content" %}
==============================================================================
{% endcomment %}

{% if variant == "fullscreen" %}
<div
    class="zu-modal-backdrop{% if active %} active{% endif %}"
    id="{{ id }}"
    role="dialog"
    aria-modal="true"
    aria-labelledby="{{ id }}-title"
    x-data="{ open: {{ active|yesno:'true,false' }} }"
    x-show="open"
    x-transition:enter="transition ease-out duration-200"
    x-transition:enter-start="opacity-0"
    x-transition:enter-end="opacity-100"
    x-transition:leave="transition ease-in duration-150"
    x-transition:leave-start="opacity-100"
    x-transition:leave-end="opacity-0"
    @keydown.escape.window="open = false"
    style="padding: 0;"
    x-cloak
>
    <div class="zu-modal zu-modal--full{% if extra_class %} {{ extra_class }}{% endif %}"
         x-show="open"
         x-transition:enter="transition ease-out duration-200"
         x-transition:enter-start="opacity-0"
         x-transition:enter-end="opacity-100"
         style="max-width: 100vw; max-height: 100vh; border-radius: 0;">
        <div class="zu-modal__header" style="position: sticky; top: 0; z-index: 10; background: var(--zu-bg-elevated);">
            <h2 class="zu-modal__title" id="{{ id }}-title">{{ title }}</h2>
            <button type="button" class="zu-modal__close" aria-label="Close" @click="open = false">
                <svg class="zu-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                    <line x1="18" y1="6" x2="6" y2="18"></line>
                    <line x1="6" y1="6" x2="18" y2="18"></line>
                </svg>
            </button>
        </div>

        <div class="zu-modal__body" style="flex: 1; overflow-y: auto;">
            {% if body %}{{ body|safe }}{% endif %}
            {% if content %}{{ content|safe }}{% endif %}
        </div>

        {% if footer %}
        <div class="zu-modal__footer" style="position: sticky; bottom: 0; z-index: 10; background: var(--zu-bg-alt);">
            {{ footer|safe }}
        </div>
        {% endif %}
    </div>
</div>
{% endif %}

{% comment %}
==============================================================================
DRAWER MODAL (slides from side)
Usage: {% include "components/modals.html" with variant="drawer" id="drawer-menu" title="Menu" position="right" %}
==============================================================================
{% endcomment %}

{% if variant == "drawer" %}
<div
    class="zu-modal-backdrop{% if active %} active{% endif %}"
    id="{{ id }}"
    role="dialog"
    aria-modal="true"
    aria-labelledby="{{ id }}-title"
    x-data="{ open: {{ active|yesno:'true,false' }} }"
    x-show="open"
    x-transition:enter="transition ease-out duration-300"
    x-transition:enter-start="opacity-0"
    x-transition:enter-end="opacity-100"
    x-transition:leave="transition ease-in duration-200"
    x-transition:leave-start="opacity-100"
    x-transition:leave-end="opacity-0"
    @click.self="open = false"
    @keydown.escape.window="open = false"
    style="justify-content: {% if position == 'left' %}flex-start{% else %}flex-end{% endif %}; padding: 0;"
    x-cloak
>
    <div
        class="zu-modal{% if extra_class %} {{ extra_class }}{% endif %}"
        x-show="open"
        x-transition:enter="transition ease-out duration-300"
        x-transition:enter-start="{% if position == 'left' %}-translate-x-full{% else %}translate-x-full{% endif %}"
        x-transition:enter-end="translate-x-0"
        x-transition:leave="transition ease-in duration-200"
        x-transition:leave-start="translate-x-0"
        x-transition:leave-end="{% if position == 'left' %}-translate-x-full{% else %}translate-x-full{% endif %}"
        style="height: 100vh; max-height: 100vh; border-radius: 0; width: {{ width|default:'320px' }}; max-width: 100vw;"
    >
        <div class="zu-modal__header">
            <h2 class="zu-modal__title" id="{{ id }}-title">{{ title }}</h2>
            <button type="button" class="zu-modal__close" aria-label="Close" @click="open = false">
                <svg class="zu-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                    <line x1="18" y1="6" x2="6" y2="18"></line>
                    <line x1="6" y1="6" x2="18" y2="18"></line>
                </svg>
            </button>
        </div>

        <div class="zu-modal__body" style="flex: 1; overflow-y: auto;">
            {% if body %}{{ body|safe }}{% endif %}
            {% if content %}{{ content|safe }}{% endif %}
        </div>

        {% if footer %}
        <div class="zu-modal__footer">
            {{ footer|safe }}
        </div>
        {% endif %}
    </div>
</div>
{% endif %}

{% comment %}
==============================================================================
IMAGE/MEDIA MODAL (for viewing images/videos)
Usage: {% include "components/modals.html" with variant="media" id="media-viewer" image_src="/path/to/image.jpg" image_alt="Description" %}
==============================================================================
{% endcomment %}

{% if variant == "media" %}
<div
    class="zu-modal-backdrop{% if active %} active{% endif %}"
    id="{{ id }}"
    role="dialog"
    aria-modal="true"
    aria-label="{{ image_alt|default:'Media viewer' }}"
    x-data="{ open: {{ active|yesno:'true,false' }} }"
    x-show="open"
    x-transition:enter="transition ease-out duration-200"
    x-transition:enter-start="opacity-0"
    x-transition:enter-end="opacity-100"
    x-transition:leave="transition ease-in duration-150"
    x-transition:leave-start="opacity-100"
    x-transition:leave-end="opacity-0"
    @click.self="open = false"
    @keydown.escape.window="open = false"
    style="background-color: rgba(0, 0, 0, 0.9);"
    x-cloak
>
    <button
        type="button"
        class="zu-modal__close"
        aria-label="Close"
        @click="open = false"
        style="position: absolute; top: var(--zu-space-4); right: var(--zu-space-4); color: white; z-index: 10;"
    >
        <svg class="zu-icon--lg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
            <line x1="18" y1="6" x2="6" y2="18"></line>
            <line x1="6" y1="6" x2="18" y2="18"></line>
        </svg>
    </button>

    <div class="zu-flex zu-items-center zu-justify-center" style="width: 100%; height: 100%;"
         x-show="open"
         x-transition:enter="transition ease-out duration-300"
         x-transition:enter-start="opacity-0 scale-95"
         x-transition:enter-end="opacity-100 scale-100">
        {% if video_src %}
        <video
            src="{{ video_src }}"
            controls
            style="max-width: 90vw; max-height: 90vh;"
            {% if video_poster %}poster="{{ video_poster }}"{% endif %}
        >
            Your browser does not support the video tag.
        </video>
        {% else %}
        <img
            src="{{ image_src }}"
            alt="{{ image_alt }}"
            style="max-width: 90vw; max-height: 90vh; object-fit: contain;"
        >
        {% endif %}
    </div>

    {% if caption %}
    <div style="position: absolute; bottom: var(--zu-space-4); left: 50%; transform: translateX(-50%); color: white; text-align: center; padding: var(--zu-space-2) var(--zu-space-4); background-color: rgba(0, 0, 0, 0.5); border-radius: var(--zu-radius-md);">
        {{ caption }}
    </div>
    {% endif %}
</div>
{% endif %}

{% comment %}
==============================================================================
MODAL CSS ADDITIONS (to be added to zumodra-design-system.css if not present)
==============================================================================
{% endcomment %}

{% if variant == "styles" %}
<style>
/* Modal Icon Styles */
.zu-modal__icon {
    width: 64px;
    height: 64px;
    margin: 0 auto var(--zu-space-4);
    border-radius: var(--zu-radius-full);
    display: flex;
    align-items: center;
    justify-content: center;
}

.zu-modal__icon--success {
    background-color: var(--zu-success-100);
    color: var(--zu-success-600);
}

.zu-modal__icon--error {
    background-color: var(--zu-error-100);
    color: var(--zu-error-600);
}

.zu-modal__icon--warning {
    background-color: var(--zu-warning-100);
    color: var(--zu-warning-600);
}

.zu-modal__icon--info {
    background-color: var(--zu-info-100);
    color: var(--zu-info-600);
}
</style>
{% endif %}
