{% comment %} =============================================================================
   ZUMODRA PROJECT CARD COMPONENT
   =============================================================================

   File: templates/components/marketplace/cards/project_card.html
   Purpose: Display project listings in grid or list layouts

   Usage:
   {% include "components/marketplace/cards/project_card.html" with project=project %}
   {% include "components/marketplace/cards/project_card.html" with project=project layout="list" %}

   Parameters:
   - project: Project object
   - layout: "grid" (default) or "list"
   - show_wishlist: Boolean to show/hide bookmark button (default: True)

   Author: Rhematek Solutions
   Last Updated: 2026-01-03
   ============================================================================= {% endcomment %}

{% load i18n static %}

{% if layout == "list" %}
{% comment %} List Layout {% endcomment %}
<li class="projects_item projects_item_list flex items-start gap-5 relative p-6 rounded-lg bg-white duration-300 shadow-lg hover:shadow-2xl">
    <div class="projects_content flex-grow">
        <div class="flex flex-wrap items-start justify-between gap-4">
            <div class="flex-grow">
                <a href="{{ project.get_absolute_url }}">
                    <strong class="projects_name text-title duration-300 hover:text-primary">{{ project.title }}</strong>
                </a>
                <div class="flex flex-wrap items-center gap-4 mt-2">
                    {% if project.category %}
                    <span class="tag caption2 bg-surface">{{ project.category.name }}</span>
                    {% endif %}
                    {% if project.location %}
                    <div class="flex items-center gap-1">
                        <span class="ph ph-map-pin text-lg text-secondary"></span>
                        <span class="caption1 text-secondary">{{ project.location }}</span>
                    </div>
                    {% endif %}
                    <div class="flex items-center gap-1">
                        <span class="ph ph-calendar-blank text-lg text-secondary"></span>
                        <span class="caption1 text-secondary">{{ project.created_at|timesince }} {% trans 'ago' %}</span>
                    </div>
                </div>
            </div>
            {% if show_wishlist|default:True %}
            <button class="add_wishlist_btn -relative -border"
                    hx-post="{% url 'services:project_bookmark' project.id %}"
                    hx-swap="outerHTML"
                    aria-label="{% trans 'Save project' %}">
                <span class="ph ph-heart text-xl"></span>
                <span class="ph-fill ph-heart text-xl hidden"></span>
            </button>
            {% endif %}
        </div>

        {% if project.description %}
        <p class="projects_desc text-secondary mt-3 line-clamp-2">
            {{ project.description|truncatewords:40 }}
        </p>
        {% endif %}

        {% comment %} Skills/Tags {% endcomment %}
        <div class="flex flex-wrap items-center gap-2 mt-3">
            {% for skill in project.skills_required.all|slice:":5" %}
            <span class="tag caption2 bg-surface">{{ skill.name }}</span>
            {% endfor %}
        </div>

        <div class="projects_more_info flex flex-wrap items-center justify-between gap-4 mt-4 pt-4 border-t border-line">
            <div class="flex items-center gap-4">
                {% comment %} Client Info {% endcomment %}
                <a href="{{ project.client.get_absolute_url }}" class="flex items-center gap-2">
                    {% if project.client.logo %}
                    <img src="{{ project.client.logo.url }}" alt="{{ project.client.name }}" class="w-8 h-8 rounded-full object-cover" />
                    {% else %}
                    <div class="w-8 h-8 rounded-full bg-primary/10 flex items-center justify-center">
                        <span class="ph-fill ph-buildings text-sm text-primary"></span>
                    </div>
                    {% endif %}
                    <span class="text-sm text-secondary">{{ project.client.name }}</span>
                </a>
                {% comment %} Proposals Count {% endcomment %}
                <span class="text-sm text-secondary">
                    <span class="ph-bold ph-user-list mr-1"></span>
                    {{ project.proposals_count|default:0 }} {% trans 'proposals' %}
                </span>
            </div>
            {% comment %} Budget {% endcomment %}
            <div class="projects_price">
                {% if project.budget_min and project.budget_max %}
                <span class="price text-title">${{ project.budget_min|floatformat:0 }} - ${{ project.budget_max|floatformat:0 }}</span>
                {% elif project.budget_min %}
                <span class="price text-title">{% trans 'From' %} ${{ project.budget_min|floatformat:0 }}</span>
                {% else %}
                <span class="text-secondary">{% trans 'Budget negotiable' %}</span>
                {% endif %}
            </div>
        </div>
    </div>
</li>

{% else %}
{% comment %} Grid Layout (Default) {% endcomment %}
<li class="projects_item relative p-6 rounded-lg bg-white duration-300 shadow-lg hover:shadow-2xl">
    <div class="projects_inner">
        {% comment %} Header {% endcomment %}
        <div class="flex items-start justify-between gap-2">
            <a href="{{ project.get_absolute_url }}">
                <strong class="projects_name text-title duration-300 hover:text-primary line-clamp-2">{{ project.title }}</strong>
            </a>
            {% if show_wishlist|default:True %}
            <button class="add_wishlist_btn -relative -border flex-shrink-0"
                    hx-post="{% url 'services:project_bookmark' project.id %}"
                    hx-swap="outerHTML"
                    aria-label="{% trans 'Save project' %}">
                <span class="ph ph-heart text-xl"></span>
                <span class="ph-fill ph-heart text-xl hidden"></span>
            </button>
            {% endif %}
        </div>

        {% comment %} Meta Info {% endcomment %}
        <div class="flex flex-wrap items-center gap-3 mt-2">
            {% if project.category %}
            <span class="tag caption2 bg-surface">{{ project.category.name }}</span>
            {% endif %}
            <div class="flex items-center gap-1">
                <span class="ph ph-calendar-blank text-lg text-secondary"></span>
                <span class="caption1 text-secondary">{{ project.created_at|timesince }} {% trans 'ago' %}</span>
            </div>
        </div>

        {% comment %} Description {% endcomment %}
        {% if project.description %}
        <p class="projects_desc text-secondary mt-3 line-clamp-3">
            {{ project.description|truncatewords:25 }}
        </p>
        {% endif %}

        {% comment %} Skills/Tags {% endcomment %}
        <div class="flex flex-wrap items-center gap-2 mt-3 pb-4 border-b border-line">
            {% for skill in project.skills_required.all|slice:":3" %}
            <span class="tag caption2 bg-surface">{{ skill.name }}</span>
            {% endfor %}
            {% if project.skills_required.count > 3 %}
            <span class="caption2 text-secondary">+{{ project.skills_required.count|add:"-3" }}</span>
            {% endif %}
        </div>

        {% comment %} Footer {% endcomment %}
        <div class="projects_more_info flex flex-wrap items-center justify-between gap-2 mt-4">
            <span class="text-sm text-secondary">
                <span class="ph-bold ph-user-list mr-1"></span>
                {{ project.proposals_count|default:0 }} {% trans 'proposals' %}
            </span>
            <div class="projects_price">
                {% if project.budget_min and project.budget_max %}
                <span class="price text-title">${{ project.budget_min|floatformat:0 }} - ${{ project.budget_max|floatformat:0 }}</span>
                {% elif project.budget_min %}
                <span class="price text-title">${{ project.budget_min|floatformat:0 }}+</span>
                {% else %}
                <span class="text-secondary">{% trans 'Negotiable' %}</span>
                {% endif %}
            </div>
        </div>
    </div>
</li>
{% endif %}
