{% comment %} =============================================================================
   ZUMODRA CANDIDATE CARD COMPONENT
   =============================================================================

   File: templates/components/marketplace/cards/candidate_card.html
   Purpose: Display freelancer/candidate profiles in grid or list layouts

   Usage:
   {% include "components/marketplace/cards/candidate_card.html" with candidate=candidate %}
   {% include "components/marketplace/cards/candidate_card.html" with candidate=candidate layout="list" %}

   Parameters:
   - candidate: Candidate/User object
   - layout: "grid" (default) or "list"
   - show_wishlist: Boolean to show/hide bookmark button (default: True)

   Author: Rhematek Solutions
   Last Updated: 2026-01-03
   ============================================================================= {% endcomment %}

{% load i18n static %}

{% if layout == "list" %}
{% comment %} List Layout {% endcomment %}
<li class="candidates_item candidates_item_list flex items-center gap-5 relative p-6 rounded-lg bg-white duration-300 shadow-lg hover:shadow-2xl">
    <a href="{{ candidate.get_absolute_url }}" class="flex-shrink-0">
        {% if candidate.profile_picture %}
        <img src="{{ candidate.profile_picture.url }}" alt="{{ candidate.get_full_name }}" class="w-20 h-20 rounded-full object-cover" />
        {% else %}
        <div class="w-20 h-20 rounded-full bg-primary flex items-center justify-center">
            <span class="text-white text-2xl font-semibold">{{ candidate.first_name|slice:":1" }}{{ candidate.last_name|slice:":1" }}</span>
        </div>
        {% endif %}
    </a>
    <div class="candidates_content flex-grow">
        <div class="flex flex-wrap items-start justify-between gap-4">
            <div>
                <a href="{{ candidate.get_absolute_url }}">
                    <strong class="candidates_name -style-1 text-title duration-300 hover:text-primary">{{ candidate.get_full_name }}</strong>
                </a>
                {% if candidate.headline %}
                <p class="text-secondary text-sm mt-0.5">{{ candidate.headline }}</p>
                {% endif %}
                <div class="flex flex-wrap items-center gap-4 mt-1">
                    {% if candidate.location %}
                    <div class="flex items-center gap-1">
                        <span class="ph ph-map-pin text-xl text-secondary"></span>
                        <span class="candidates_address -style-1 caption1 text-secondary">{{ candidate.location }}</span>
                    </div>
                    {% endif %}
                    {% if candidate.rating %}
                    <div class="flex items-center gap-1">
                        <span class="ph-fill ph-star text-yellow"></span>
                        <strong class="candidates_rate text-sm font-semibold">{{ candidate.rating|floatformat:1 }}</strong>
                        <span class="candidates_rate_quantity caption1 text-secondary">({{ candidate.review_count }} {% trans 'reviews' %})</span>
                    </div>
                    {% endif %}
                </div>
            </div>
            {% if show_wishlist|default:True %}
            <button class="add_wishlist_btn -relative -border"
                    hx-post="{% url 'ats:candidate_bookmark' candidate.id %}"
                    hx-swap="outerHTML"
                    aria-label="{% trans 'Save candidate' %}">
                <span class="ph ph-heart text-xl"></span>
                <span class="ph-fill ph-heart text-xl hidden"></span>
            </button>
            {% endif %}
        </div>
        <div class="list_tag flex items-center gap-2.5 flex-wrap mt-3">
            {% for skill in candidate.skills.all|slice:":4" %}
            <span class="candidates_tag tag bg-surface caption1">{{ skill.name }}</span>
            {% endfor %}
        </div>
        <div class="candidates_more_info flex flex-wrap items-center justify-between gap-2 mt-3 pt-3 border-t border-line">
            <span class="candidates_projects text-secondary">{{ candidate.completed_projects|default:0 }} {% trans 'Projects' %}</span>
            <div class="candidates_price">
                {% if candidate.hourly_rate %}
                <span class="price text-title">${{ candidate.hourly_rate|floatformat:0 }}</span>
                <span class="text-secondary">/{% trans 'hour' %}</span>
                {% else %}
                <span class="text-secondary">{% trans 'Rate negotiable' %}</span>
                {% endif %}
            </div>
        </div>
    </div>

    {% comment %} Top Rated Badge {% endcomment %}
    {% if candidate.is_top_rated %}
    <div class="absolute top-4 left-4 px-2 py-1 bg-yellow text-white text-xs font-semibold rounded">
        {% trans 'Top Rated' %}
    </div>
    {% endif %}
</li>

{% else %}
{% comment %} Grid Layout (Default) {% endcomment %}
<li class="candidates_item {% if candidate.is_top_rated %}is_top_rate{% endif %} relative p-6 rounded-lg bg-white duration-300 shadow-lg hover:shadow-2xl">
    <div class="candidates_innner">
        {% comment %} Candidate Profile {% endcomment %}
        <a href="{{ candidate.get_absolute_url }}" class="flex flex-col items-center justify-center">
            {% comment %} Avatar {% endcomment %}
            {% if candidate.profile_picture %}
            <img src="{{ candidate.profile_picture.url }}" alt="{{ candidate.get_full_name }}" class="w-20 h-20 rounded-full object-cover" />
            {% else %}
            <div class="w-20 h-20 rounded-full bg-primary flex items-center justify-center">
                <span class="text-white text-2xl font-semibold">{{ candidate.first_name|slice:":1" }}{{ candidate.last_name|slice:":1" }}</span>
            </div>
            {% endif %}

            {% comment %} Name {% endcomment %}
            <strong class="candidates_name -style-1 text-title mt-3 duration-300 hover:text-primary text-center">{{ candidate.get_full_name }}</strong>

            {% comment %} Headline {% endcomment %}
            {% if candidate.headline %}
            <p class="text-secondary text-sm mt-0.5 text-center line-clamp-1">{{ candidate.headline }}</p>
            {% endif %}

            {% comment %} Location {% endcomment %}
            {% if candidate.location %}
            <div class="flex items-center gap-1 mt-1">
                <span class="ph ph-map-pin text-xl text-secondary"></span>
                <span class="candidates_address -style-1 caption1 text-secondary">{{ candidate.location }}</span>
            </div>
            {% endif %}

            {% comment %} Rating {% endcomment %}
            {% if candidate.rating %}
            <div class="flex items-center gap-1 mt-1">
                <span class="ph-fill ph-star text-yellow"></span>
                <strong class="candidates_rate text-sm font-semibold">{{ candidate.rating|floatformat:1 }}</strong>
                <span class="candidates_rate_quantity caption1 text-secondary">({{ candidate.review_count }} {% trans 'reviews' %})</span>
            </div>
            {% endif %}
        </a>

        {% comment %} Skills/Tags {% endcomment %}
        <div class="list_tag flex items-center justify-center gap-2.5 flex-wrap sm:py-5 py-3 border-b border-line">
            {% for skill in candidate.skills.all|slice:":3" %}
            <span class="candidates_tag tag bg-surface caption1">{{ skill.name }}</span>
            {% endfor %}
        </div>

        {% comment %} Projects and Rate {% endcomment %}
        <div class="candidates_more_info flex flex-wrap items-center justify-between gap-2 mt-3">
            <span class="candidates_projects text-secondary">{{ candidate.completed_projects|default:0 }} {% trans 'Projects' %}</span>
            <div class="candidates_price">
                {% if candidate.hourly_rate %}
                <span class="price text-title">${{ candidate.hourly_rate|floatformat:0 }}</span>
                <span class="text-secondary">/{% trans 'hour' %}</span>
                {% else %}
                <span class="text-secondary">{% trans 'Negotiable' %}</span>
                {% endif %}
            </div>
        </div>
    </div>

    {% comment %} Wishlist Button {% endcomment %}
    {% if show_wishlist|default:True %}
    <button class="add_wishlist_btn absolute top-4 right-4"
            hx-post="{% url 'ats:candidate_bookmark' candidate.id %}"
            hx-swap="outerHTML"
            aria-label="{% trans 'Save candidate' %}">
        <span class="ph ph-heart text-xl"></span>
        <span class="ph-fill ph-heart text-xl hidden"></span>
    </button>
    {% endif %}

    {% comment %} Top Rated Badge {% endcomment %}
    {% if candidate.is_top_rated %}
    <div class="absolute top-4 left-4 px-2 py-1 bg-yellow text-white text-xs font-semibold rounded">
        {% trans 'Top Rated' %}
    </div>
    {% endif %}

    {% comment %} Verified Badge {% endcomment %}
    {% if candidate.is_verified %}
    <div class="absolute bottom-4 right-4">
        {% include "components/trust_badge.html" with level="verified" size="sm" %}
    </div>
    {% endif %}
</li>
{% endif %}
