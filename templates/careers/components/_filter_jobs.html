{% load static i18n %}

{# Jobs Filter Modal - Direct from Zumodra jobs-default.html #}
<!-- Modal -->
<div class="modal">
    <div class="sidebar min-[390px]:w-[348px] w-[80vw] h-full bg-white">
        <div class="block_filter full-height py-4 px-6">
            <form method="get" action="">
                <div class="filter_section search">
                    <strong class="text-button">search</strong>
                    <div class="form_input relative w-full h-12 mt-2">
                        <span class="icon_search ph-bold ph-magnifying-glass absolute top-1/2 -translate-y-1/2 left-3 text-xl"></span>
                        <input type="text" name="search" id="job-search-input" value="{{ search|default:'' }}" class="input_search w-full h-full pl-10 pr-3 border border-line rounded-lg" placeholder="Job title, skills, or location" />
                    </div>
                </div>
                <div class="filter_section location mt-6">
                    <strong class="text-button">Location</strong>
                    <div class="select_block flex items-center w-full h-12 pr-10 pl-3 mt-2 border border-line rounded-lg">
                        <div class="select">
                            <span class="selected capitalize" data-title="Select location">{% if selected_location %}{{ selected_location }}{% else %}Select location{% endif %}</span>
                            <div class="list_option w-full bg-white">
                                <div class="form_input relative w-full h-11">
                                    <span class="icon_search ph-bold ph-magnifying-glass absolute top-1/2 -translate-y-1/2 left-3 text-lg"></span>
                                    <input type="text" class="input_search w-full h-full pl-10 pr-3 border border-line rounded-lg" placeholder="Find location..." />
                                </div>
                                <ul class="list_result mt-3">
                                    {% for location in locations %}
                                    <li class="capitalize" data-item="{{ location }}">{{ location }}</li>
                                    {% empty %}
                                    <li class="capitalize" data-item="Africa">Africa</li>
                                    <li class="capitalize" data-item="Americas">Americas</li>
                                    <li class="capitalize" data-item="Antarctica">Antarctica</li>
                                    <li class="capitalize" data-item="Asia">Asia</li>
                                    <li class="capitalize" data-item="Europe">Europe</li>
                                    <li class="capitalize" data-item="Oceania">Oceania</li>
                                    <li class="capitalize" data-item="Australia and New Zealand">Australia and New Zealand</li>
                                    {% endfor %}
                                </ul>
                            </div>
                        </div>
                        <span class="icon_down ph ph-caret-down right-3"></span>
                    </div>
                    <input type="hidden" name="location" value="{{ selected_location|default:'' }}" class="location_value" />
                </div>
                <div class="filter_section category relative mt-6">
                    <strong class="text-button">category</strong>
                    <div class="select_block flex items-center w-full h-12 pr-10 pl-3 mt-2 border border-line rounded-lg">
                        <div class="select">
                            <span class="selected capitalize" data-title="Select category">{% if selected_category %}{{ selected_category }}{% else %}Select category{% endif %}</span>
                            <div class="list_option w-full bg-white">
                                <div class="form_input relative w-full h-11">
                                    <span class="icon_search ph-bold ph-magnifying-glass absolute top-1/2 -translate-y-1/2 left-3 text-lg"></span>
                                    <input type="text" class="input_search w-full h-full pl-10 pr-3 border border-line rounded-lg" placeholder="Find category..." />
                                </div>
                                <ul class="list_result mt-3">
                                    {% for category in categories %}
                                    <li class="capitalize" data-item="{{ category }}">{{ category }}</li>
                                    {% empty %}
                                    <li class="capitalize" data-item="Accounting & Consulting">Accounting & Consulting</li>
                                    <li class="capitalize" data-item="Admin Support">Admin Support</li>
                                    <li class="capitalize" data-item="Customer Service">Customer Service</li>
                                    <li class="capitalize" data-item="Design & Creative">Design & Creative</li>
                                    <li class="capitalize" data-item="Data Science & Analytics">Data Science & Analytics</li>
                                    <li class="capitalize" data-item="Design & Creative">Design & Creative</li>
                                    <li class="capitalize" data-item="Engineering & Architecture">Engineering & Architecture</li>
                                    <li class="capitalize" data-item="IT & Networking">IT & Networking</li>
                                    {% endfor %}
                                </ul>
                            </div>
                        </div>
                        <span class="icon_down ph ph-caret-down right-3"></span>
                    </div>
                    <input type="hidden" name="category" value="{{ selected_category|default:'' }}" class="category_value" />
                </div>
                <div class="filter_section type relative mt-6">
                    <strong class="text-button">Job types</strong>
                    <div class="select_block flex items-center w-full h-12 pr-10 pl-3 mt-2 border border-line rounded-lg">
                        <div class="select">
                            <span class="selected capitalize" data-title="Select job types">{% if selected_job_type %}{{ selected_job_type }}{% else %}Select job types{% endif %}</span>
                            <ul class="list_option w-full bg-white">
                                <li class="capitalize" data-item="Freelance">Freelance</li>
                                <li class="capitalize" data-item="Full Time">Full Time</li>
                                <li class="capitalize" data-item="Internship">Internship</li>
                                <li class="capitalize" data-item="On-site">On-site</li>
                                <li class="capitalize" data-item="Part Time">Part Time</li>
                                <li class="capitalize" data-item="Remote">Remote</li>
                                <li class="capitalize" data-item="Temporary">Temporary</li>
                            </ul>
                        </div>
                        <span class="icon_down ph ph-caret-down right-3"></span>
                    </div>
                    <input type="hidden" name="job_type" value="{{ selected_job_type|default:'' }}" class="job_type_value" />
                </div>
                <div class="filter_section filter_price mt-6">
                    <strong class="text-button">Filter by salary</strong>
                    <div class="tow_bar_block mt-5">
                        <div class="progress"></div>
                    </div>
                    <div class="range_input">
                        <input class="input range_min" name="salary_min_range" type="range" min="0" max="300000" value="{{ salary_min|default:0 }}" />
                        <input class="input range_max" name="salary_max_range" type="range" min="0" max="300000" value="{{ salary_max|default:300000 }}" />
                    </div>
                    <div class="price_block flex items-center justify-between mt-4">
                        <div class="price_min flex items-center overflow-hidden relative w-32 h-10">
                            <span class="text-button text-secondary absolute top-1/2 -translate-y-1/2 left-3">$</span>
                            <input type="number" name="salary_min" class="caption1 w-full h-full pl-7 pr-10 border border-line rounded-lg" value="{{ salary_min|default:0 }}" />
                            <span class="caption1 text-placehover absolute top-1/2 -translate-y-1/2 right-3">min</span>
                        </div>
                        <span class="ph-bold ph-minus text-xl"></span>
                        <div class="price_max flex items-center overflow-hidden relative w-32 h-10">
                            <span class="text-button text-secondary absolute top-1/2 -translate-y-1/2 left-3">$</span>
                            <input type="number" name="salary_max" class="caption1 w-full h-full pl-7 pr-10 border border-line rounded-lg" value="{{ salary_max|default:300000 }}" />
                            <span class="caption1 text-placehover absolute top-1/2 -translate-y-1/2 right-3">max</span>
                        </div>
                    </div>
                </div>
                <div class="filter_section hourly mt-6">
                    <strong class="text-button">Filter by Hourly</strong>
                    <div class="hour_block flex items-center justify-between mt-2">
                        <div class="min flex items-center overflow-hidden relative w-32 h-10">
                            <span class="text-button text-secondary absolute top-1/2 -translate-y-1/2 left-3">$</span>
                            <input type="number" name="hourly_min" class="caption1 w-full h-full pl-7 pr-10 border border-line rounded-lg" value="{{ hourly_min|default:'' }}" />
                            <span class="caption1 text-placehover absolute top-1/2 -translate-y-1/2 right-3">min</span>
                        </div>
                        <span class="ph-bold ph-minus text-xl"></span>
                        <div class="max flex items-center overflow-hidden relative w-32 h-10">
                            <span class="text-button text-secondary absolute top-1/2 -translate-y-1/2 left-3">$</span>
                            <input type="number" name="hourly_max" class="caption1 w-full h-full pl-7 pr-10 border border-line rounded-lg" value="{{ hourly_max|default:'' }}" />
                            <span class="caption1 text-placehover absolute top-1/2 -translate-y-1/2 right-3">max</span>
                        </div>
                    </div>
                </div>
                <div class="filter_section filter_radius mt-6">
                    <strong class="text-button">
                        <span>Radius: </span>
                        <span class="radius text-primary">{% if radius %}{{ radius }}km{% else %}100km{% endif %}</span>
                    </strong>
                    <div class="tow_bar_block mt-5">
                        <div class="progress"></div>
                    </div>
                    <div class="range_input">
                        <input class="input range_max" name="radius" type="range" min="1" max="100" value="{{ radius|default:100 }}" />
                    </div>
                </div>
                <div class="filter_section industry mt-6">
                    <strong class="text-button">Industry</strong>
                    <div class="select_block flex items-center w-full h-12 pr-10 pl-3 mt-2 border border-line rounded-lg">
                        <div class="select">
                            <span class="selected capitalize" data-title="Select industry">{% if selected_industry %}{{ selected_industry }}{% else %}Select industry{% endif %}</span>
                            <ul class="list_option -top w-full bg-white">
                                {% for industry in industries %}
                                <li class="capitalize" data-item="{{ industry }}">{{ industry }}</li>
                                {% empty %}
                                <li class="capitalize" data-item="Development">Development</li>
                                <li class="capitalize" data-item="Management">Management</li>
                                <li class="capitalize" data-item="Finance">Finance</li>
                                <li class="capitalize" data-item="Html & Css">Html & Css</li>
                                <li class="capitalize" data-item="Seo">Seo</li>
                                <li class="capitalize" data-item="Banking">Banking</li>
                                <li class="capitalize" data-item="Design Graphics">Design Graphics</li>
                                {% endfor %}
                            </ul>
                        </div>
                        <span class="icon_down ph ph-caret-down right-3"></span>
                    </div>
                    <input type="hidden" name="industry" value="{{ selected_industry|default:'' }}" class="industry_value" />
                </div>
                <div class="filter_section career mt-6">
                    <strong class="text-button">Career Level</strong>
                    <div class="select_block flex items-center w-full h-12 pr-10 pl-3 mt-2 border border-line rounded-lg">
                        <div class="select">
                            <span class="selected capitalize" data-title="Select career level">{% if selected_career_level %}{{ selected_career_level }}{% else %}Select career level{% endif %}</span>
                            <ul class="list_option -top w-full bg-white">
                                <li class="capitalize" data-item="Manager">Manager</li>
                                <li class="capitalize" data-item="Officer">Officer</li>
                                <li class="capitalize" data-item="Student">Student</li>
                                <li class="capitalize" data-item="Executive">Executive</li>
                                <li class="capitalize" data-item="Others">Others</li>
                            </ul>
                        </div>
                        <span class="icon_down ph ph-caret-down right-3"></span>
                    </div>
                    <input type="hidden" name="career_level" value="{{ selected_career_level|default:'' }}" class="career_value" />
                </div>
                <div class="filter_section experience mt-6">
                    <strong class="text-button">Experience level</strong>
                    <div class="list_level flex flex-col gap-2 mt-2">
                        <div class="checkbox_block">
                            <input type="checkbox" name="experience" value="entry" class="checkbox" id="entry" data-label="entry" {% if 'entry' in selected_experience %}checked{% endif %} />
                            <span class="ph-fill ph-check-square text-xl check_icon"></span>
                            <label class="label pl-6" for="entry">Entry Level</label>
                        </div>
                        <div class="checkbox_block">
                            <input type="checkbox" name="experience" value="intermediate" class="checkbox" id="intermediate" data-label="intermediate" {% if 'intermediate' in selected_experience %}checked{% endif %} />
                            <span class="ph-fill ph-check-square text-xl check_icon"></span>
                            <label class="label pl-6" for="intermediate">Intermediate</label>
                        </div>
                        <div class="checkbox_block">
                            <input type="checkbox" name="experience" value="expert" class="checkbox" id="expert" data-label="expert" {% if 'expert' in selected_experience %}checked{% endif %} />
                            <span class="ph-fill ph-check-square text-xl check_icon"></span>
                            <label class="label pl-6" for="expert">Expert</label>
                        </div>
                    </div>
                </div>
                <button type="submit" class="button-main w-full mt-6 text-center">Find Jobs</button>
            </form>
            <form method="post" action="{% url 'careers:job_alert_save' %}" class="md:mt-10 mt-7">
                {% csrf_token %}
                <h6 class="heading6">Job Alert</h6>
                <div class="filter_section title mt-6">
                    <strong class="text-button">title</strong>
                    <div class="form_input relative w-full h-12 mt-2">
                        <input type="text" name="alert_title" class="input_title w-full h-full px-3 border border-line rounded-lg" placeholder="Title alert" required />
                    </div>
                </div>
                <div class="filter_section frequency mt-6">
                    <strong class="text-button">Email frequency</strong>
                    <div class="select_block flex items-center w-full h-12 pr-10 pl-3 mt-2 border border-line rounded-lg">
                        <div class="select">
                            <span class="selected capitalize" data-title="Select frequency">Select frequency</span>
                            <ul class="list_option -top w-full bg-white">
                                <li class="capitalize" data-item="Daily">Daily</li>
                                <li class="capitalize" data-item="Weekly">Weekly</li>
                                <li class="capitalize" data-item="Fortnightly">Fortnightly</li>
                                <li class="capitalize" data-item="Monthly">Monthly</li>
                                <li class="capitalize" data-item="Biannually">Biannually</li>
                                <li class="capitalize" data-item="Annually">Annually</li>
                            </ul>
                        </div>
                        <span class="icon_down ph ph-caret-down right-3"></span>
                    </div>
                    <input type="hidden" name="frequency" value="" class="frequency_value" />
                </div>
                <button type="submit" class="button-main w-full mt-6 text-center">Save Candidate Alert</button>
            </form>
        </div>
    </div>
</div>

<script src="{% static 'assets/js/address-autocomplete.js' %}"></script>
<script>
// Jobs Filter - Sync dropdowns with hidden inputs
document.addEventListener('DOMContentLoaded', function() {
    // Initialize address autocomplete on search input
    const jobSearchAutocomplete = new AddressAutocomplete('#job-search-input', {
        placeholder: 'Job title, skills, or location',
        minLength: 2,
        debounceDelay: 400,
        onSelect: function(data) {
            console.log('Selected address:', data);
            // Auto-fill location dropdown
            if (data.address && data.address.city) {
                const locationValue = document.querySelector('.location_value');
                const locationSelected = document.querySelector('.filter_section.location .selected');
                if (locationValue) locationValue.value = data.address.city;
                if (locationSelected) locationSelected.textContent = data.address.city;
            }
        }
    });

    // Location
    document.querySelectorAll('.filter_section.location .list_option li').forEach(option => {
        option.addEventListener('click', function() {
            const value = this.getAttribute('data-item');
            const input = document.querySelector('.location_value');
            const selected = document.querySelector('.filter_section.location .selected');
            if (input) input.value = value;
            if (selected) selected.textContent = value;
        });
    });

    // Category
    document.querySelectorAll('.filter_section.category .list_option li').forEach(option => {
        option.addEventListener('click', function() {
            const value = this.getAttribute('data-item');
            const input = document.querySelector('.category_value');
            const selected = document.querySelector('.filter_section.category .selected');
            if (input) input.value = value;
            if (selected) selected.textContent = value;
        });
    });

    // Job Type
    document.querySelectorAll('.filter_section.type .list_option li').forEach(option => {
        option.addEventListener('click', function() {
            const value = this.getAttribute('data-item');
            const input = document.querySelector('.job_type_value');
            const selected = document.querySelector('.filter_section.type .selected');
            if (input) input.value = value;
            if (selected) selected.textContent = value;
        });
    });

    // Industry
    document.querySelectorAll('.filter_section.industry .list_option li').forEach(option => {
        option.addEventListener('click', function() {
            const value = this.getAttribute('data-item');
            const input = document.querySelector('.industry_value');
            const selected = document.querySelector('.filter_section.industry .selected');
            if (input) input.value = value;
            if (selected) selected.textContent = value;
        });
    });

    // Career Level
    document.querySelectorAll('.filter_section.career .list_option li').forEach(option => {
        option.addEventListener('click', function() {
            const value = this.getAttribute('data-item');
            const input = document.querySelector('.career_value');
            const selected = document.querySelector('.filter_section.career .selected');
            if (input) input.value = value;
            if (selected) selected.textContent = value;
        });
    });

    // Frequency (Job Alert form)
    document.querySelectorAll('.filter_section.frequency .list_option li').forEach(option => {
        option.addEventListener('click', function() {
            const value = this.getAttribute('data-item');
            const input = document.querySelector('.frequency_value');
            const selected = document.querySelector('.filter_section.frequency .selected');
            if (input) input.value = value;
            if (selected) selected.textContent = value;
        });
    });

    // Radius slider update
    const radiusSlider = document.querySelector('.filter_section.filter_radius .range_max');
    const radiusDisplay = document.querySelector('.filter_section.filter_radius .radius');
    if (radiusSlider && radiusDisplay) {
        radiusSlider.addEventListener('input', function() {
            radiusDisplay.textContent = this.value + 'km';
        });
    }
});
</script>
