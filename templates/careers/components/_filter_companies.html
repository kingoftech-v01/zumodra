{% load static i18n %}

{# Companies Filter Modal - Direct from FreelanHub employers-default.html #}
<!-- Modal -->
<div class="modal">
    <div class="sidebar min-[390px]:w-[348px] w-[80vw] h-full bg-white">
        <form method="get" action="{% url 'careers:browse_companies' %}" class="h-full">
            <div class="block_filter h-full py-4 px-6">
                <div class="filter_section search">
                    <strong class="text-button">search</strong>
                    <div class="form_input relative w-full h-12 mt-2">
                        <span class="icon_search ph-bold ph-magnifying-glass absolute top-1/2 -translate-y-1/2 left-3 text-xl"></span>
                        <input type="text" name="search" id="company-search-input" value="{{ search|default:'' }}" class="input_search w-full h-full pl-10 pr-3 border border-line rounded-lg" placeholder="Search by name, industry, or location" />
                    </div>
                </div>
                <div class="filter_section location mt-6">
                    <strong class="text-button">Location</strong>
                    <div class="select_block flex items-center w-full h-12 pr-10 pl-3 mt-2 border border-line rounded-lg">
                        <div class="select">
                            <span class="selected capitalize" data-title="Select location">{% if selected_location %}{{ selected_location }}{% else %}Select location{% endif %}</span>
                            <div class="list_option w-full bg-white">
                                <div class="form_input relative w-full h-11">
                                    <span class="icon_search ph-bold ph-magnifying-glass absolute top-1/2 -translate-y-1/2 left-3 text-lg"></span>
                                    <input type="text" class="input_search w-full h-full pl-10 pr-3 border border-line rounded-lg" placeholder="Find location..." />
                                </div>
                                <ul class="list_result mt-3">
                                    {% for location in locations %}
                                    <li class="capitalize" data-item="{{ location }}">{{ location }}</li>
                                    {% empty %}
                                    <li class="capitalize" data-item="Africa">Africa</li>
                                    <li class="capitalize" data-item="Americas">Americas</li>
                                    <li class="capitalize" data-item="Antarctica">Antarctica</li>
                                    <li class="capitalize" data-item="Asia">Asia</li>
                                    <li class="capitalize" data-item="Europe">Europe</li>
                                    <li class="capitalize" data-item="Oceania">Oceania</li>
                                    <li class="capitalize" data-item="Australia and New Zealand">Australia and New Zealand</li>
                                    {% endfor %}
                                </ul>
                            </div>
                        </div>
                        <span class="icon_down ph ph-caret-down right-3"></span>
                    </div>
                    <input type="hidden" name="location" value="{{ selected_location|default:'' }}" class="location_value" />
                </div>
                <div class="filter_section category relative mt-6">
                    <strong class="text-button">category</strong>
                    <div class="select_block flex items-center w-full h-12 pr-10 pl-3 mt-2 border border-line rounded-lg">
                        <div class="select">
                            <span class="selected capitalize" data-title="Select category">{% if selected_industry %}{{ selected_industry }}{% else %}Select category{% endif %}</span>
                            <div class="list_option w-full bg-white">
                                <div class="form_input relative w-full h-11">
                                    <span class="icon_search ph-bold ph-magnifying-glass absolute top-1/2 -translate-y-1/2 left-3 text-lg"></span>
                                    <input type="text" class="input_search w-full h-full pl-10 pr-3 border border-line rounded-lg" placeholder="Find category..." />
                                </div>
                                <ul class="list_result mt-3">
                                    {% for industry in industries %}
                                    <li class="capitalize" data-item="{{ industry }}">{{ industry }}</li>
                                    {% empty %}
                                    <li class="capitalize" data-item="Accounting & Consulting">Accounting & Consulting</li>
                                    <li class="capitalize" data-item="Admin Support">Admin Support</li>
                                    <li class="capitalize" data-item="Customer Service">Customer Service</li>
                                    <li class="capitalize" data-item="Design & Creative">Design & Creative</li>
                                    <li class="capitalize" data-item="Data Science & Analytics">Data Science & Analytics</li>
                                    <li class="capitalize" data-item="Engineering & Architecture">Engineering & Architecture</li>
                                    <li class="capitalize" data-item="IT & Networking">IT & Networking</li>
                                    {% endfor %}
                                </ul>
                            </div>
                        </div>
                        <span class="icon_down ph ph-caret-down right-3"></span>
                    </div>
                    <input type="hidden" name="industry" value="{{ selected_industry|default:'' }}" class="industry_value" />
                </div>
                <div class="filter_section filter_radius mt-6">
                    <strong class="text-button">
                        <span>Radius: </span>
                        <span class="radius text-primary">{% if radius %}{{ radius }}km{% else %}100km{% endif %}</span>
                    </strong>
                    <div class="tow_bar_block mt-5">
                        <div class="progress"></div>
                    </div>
                    <div class="range_input">
                        <input class="input range_max" type="range" name="radius" min="1" max="100" value="{{ radius|default:100 }}" />
                    </div>
                </div>
                <div class="filter_section size mt-6">
                    <strong class="text-button">Company Size</strong>
                    <div class="select_block flex items-center w-full h-12 pr-10 pl-3 mt-2 border border-line rounded-lg">
                        <div class="select">
                            <span class="selected capitalize" data-title="Select Company Size">{% if selected_size %}{{ selected_size }}{% else %}Select Company Size{% endif %}</span>
                            <ul class="list_option w-full bg-white">
                                <li class="capitalize" data-item="1-5 employees">1-5 employees</li>
                                <li class="capitalize" data-item="5-20 employees">5-20 employees</li>
                                <li class="capitalize" data-item="20-50 employees">20-50 employees</li>
                                <li class="capitalize" data-item="50-100 employees">50-100 employees</li>
                                <li class="capitalize" data-item="100-200 employees">100-200 employees</li>
                            </ul>
                        </div>
                        <span class="icon_down ph ph-caret-down right-3"></span>
                    </div>
                    <input type="hidden" name="company_size" value="{{ selected_size|default:'' }}" class="size_value" />
                </div>
            </div>
            <div class="block_btn absolute right-0 bottom-0 left-0 z-[1] bg-white h-[68px] py-2.5 px-6">
                <button type="submit" class="button-main w-full text-center">Find Employers</button>
            </div>
        </form>
    </div>
</div>

<script src="{% static 'assets/js/address-autocomplete.js' %}"></script>
<script>
// Filter Modal - Sync select dropdowns with hidden inputs
document.addEventListener('DOMContentLoaded', function() {
    // Initialize address autocomplete on search input
    const searchAutocomplete = new AddressAutocomplete('#company-search-input', {
        placeholder: 'Search by name, industry, or location',
        minLength: 2,
        debounceDelay: 400,
        onSelect: function(data) {
            console.log('Selected address:', data);
            // Optionally auto-fill location dropdown
            if (data.address && data.address.city) {
                const locationValue = document.querySelector('.location_value');
                const locationSelected = document.querySelector('.filter_section.location .selected');
                if (locationValue) locationValue.value = data.address.city;
                if (locationSelected) locationSelected.textContent = data.address.city;
            }
        }
    });

    // Location select
    const locationOptions = document.querySelectorAll('.filter_section.location .list_option li');
    const locationValue = document.querySelector('.location_value');
    const locationSelected = document.querySelector('.filter_section.location .selected');

    locationOptions.forEach(option => {
        option.addEventListener('click', function() {
            const value = this.getAttribute('data-item');
            if (locationValue) locationValue.value = value;
            if (locationSelected) locationSelected.textContent = value;
        });
    });

    // Industry/Category select
    const industryOptions = document.querySelectorAll('.filter_section.category .list_option li');
    const industryValue = document.querySelector('.industry_value');
    const industrySelected = document.querySelector('.filter_section.category .selected');

    industryOptions.forEach(option => {
        option.addEventListener('click', function() {
            const value = this.getAttribute('data-item');
            if (industryValue) industryValue.value = value;
            if (industrySelected) industrySelected.textContent = value;
        });
    });

    // Company size select
    const sizeOptions = document.querySelectorAll('.filter_section.size .list_option li');
    const sizeValue = document.querySelector('.size_value');
    const sizeSelected = document.querySelector('.filter_section.size .selected');

    sizeOptions.forEach(option => {
        option.addEventListener('click', function() {
            const value = this.getAttribute('data-item');
            if (sizeValue) sizeValue.value = value;
            if (sizeSelected) sizeSelected.textContent = value;
        });
    });

    // Radius slider update
    const radiusSlider = document.querySelector('.filter_section.filter_radius .range_max');
    const radiusDisplay = document.querySelector('.filter_section.filter_radius .radius');

    if (radiusSlider && radiusDisplay) {
        radiusSlider.addEventListener('input', function() {
            radiusDisplay.textContent = this.value + 'km';
        });
    }
});
</script>
