# Generated by Django 5.2.7 on 2026-01-18 07:40

import django.contrib.gis.db.models.fields
import django.core.validators
import django.db.models.deletion
import uuid
from decimal import Decimal
from django.conf import settings
from django.db import migrations, models


class Migration(migrations.Migration):

    initial = True

    dependencies = [
        ('configurations', '0002_initial'),
        ('escrow', '0001_initial'),
        ('tenants', '0001_initial'),
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        migrations.CreateModel(
            name='ServiceCategory',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True, verbose_name='Created at')),
                ('updated_at', models.DateTimeField(auto_now=True, db_index=True, verbose_name='Updated at')),
                ('is_active', models.BooleanField(db_index=True, default=True, help_text='Designates whether this record is active.', verbose_name='Is active')),
                ('name', models.CharField(help_text='Category name', max_length=100)),
                ('slug', models.SlugField(blank=True, max_length=100)),
                ('description', models.TextField(blank=True)),
                ('icon', models.CharField(blank=True, help_text='Icon class name', max_length=50)),
                ('color', models.CharField(default='#3B82F6', max_length=7)),
                ('sort_order', models.PositiveIntegerField(default=0)),
                ('parent', models.ForeignKey(blank=True, help_text='Parent category for hierarchy', null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='subcategories', to='services.servicecategory')),
                ('tenant', models.ForeignKey(help_text='The tenant this record belongs to.', on_delete=django.db.models.deletion.CASCADE, related_name='%(app_label)s_%(class)s_set', to='tenants.tenant', verbose_name='Tenant')),
            ],
            options={
                'verbose_name': 'Service Category',
                'verbose_name_plural': 'Service Categories',
                'ordering': ['sort_order', 'name'],
            },
        ),
        migrations.CreateModel(
            name='Service',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True, verbose_name='Created at')),
                ('updated_at', models.DateTimeField(auto_now=True, db_index=True, verbose_name='Updated at')),
                ('uuid', models.UUIDField(default=uuid.uuid4, editable=False, unique=True)),
                ('name', models.CharField(max_length=255)),
                ('slug', models.SlugField(blank=True, max_length=255)),
                ('description', models.TextField(blank=True)),
                ('short_description', models.CharField(blank=True, max_length=300)),
                ('service_type', models.CharField(choices=[('fixed', 'Fixed Price'), ('hourly', 'Hourly Rate'), ('custom', 'Custom Quote')], db_index=True, default='fixed', max_length=20)),
                ('price', models.DecimalField(blank=True, db_index=True, decimal_places=2, help_text='Price for fixed-price services', max_digits=10, null=True)),
                ('price_min', models.DecimalField(blank=True, db_index=True, decimal_places=2, help_text='Minimum price for custom quotes', max_digits=10, null=True)),
                ('price_max', models.DecimalField(blank=True, db_index=True, decimal_places=2, max_digits=10, null=True)),
                ('currency', models.CharField(db_index=True, default='CAD', max_length=3)),
                ('delivery_type', models.CharField(choices=[('remote', 'Remote'), ('onsite', 'On-Site'), ('hybrid', 'Hybrid')], db_index=True, default='remote', max_length=20)),
                ('duration_days', models.PositiveSmallIntegerField(blank=True, db_index=True, help_text='Estimated delivery time in days', null=True)),
                ('revisions_included', models.PositiveSmallIntegerField(default=1)),
                ('thumbnail', models.ImageField(blank=True, null=True, upload_to='service_thumbnails/')),
                ('video_url', models.URLField(blank=True)),
                ('is_active', models.BooleanField(db_index=True, default=True, help_text='Service is active and available for booking within tenant')),
                ('is_featured', models.BooleanField(db_index=True, default=False, help_text='Featured services appear prominently in tenant marketplace')),
                ('is_public', models.BooleanField(db_index=True, default=False, help_text='Publish to public marketplace (visible to all users/companies)')),
                ('published_to_catalog', models.BooleanField(default=False, help_text='Service is currently synced to public catalog')),
                ('catalog_synced_at', models.DateTimeField(blank=True, help_text='Last sync timestamp with public catalog', null=True)),
                ('view_count', models.PositiveIntegerField(default=0)),
                ('order_count', models.PositiveIntegerField(default=0)),
                ('location_coordinates', django.contrib.gis.db.models.fields.PointField(blank=True, help_text='Geographic coordinates for service location (lon, lat)', null=True, srid=4326)),
                ('geocode_attempted', models.BooleanField(default=False, help_text='Whether geocoding has been attempted')),
                ('geocode_error', models.CharField(blank=True, default='', help_text='Error message if geocoding failed', max_length=255)),
                ('tenant', models.ForeignKey(help_text='The tenant this record belongs to.', on_delete=django.db.models.deletion.CASCADE, related_name='%(app_label)s_%(class)s_set', to='tenants.tenant', verbose_name='Tenant')),
                ('category', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='services', to='services.servicecategory')),
            ],
            options={
                'verbose_name': 'Service',
                'verbose_name_plural': 'Services',
                'ordering': ['-is_featured', '-created_at'],
            },
        ),
        migrations.CreateModel(
            name='ClientRequest',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True, verbose_name='Created at')),
                ('updated_at', models.DateTimeField(auto_now=True, db_index=True, verbose_name='Updated at')),
                ('is_active', models.BooleanField(db_index=True, default=True, help_text='Designates whether this record is active.', verbose_name='Is active')),
                ('uuid', models.UUIDField(default=uuid.uuid4, editable=False, unique=True)),
                ('title', models.CharField(max_length=255)),
                ('description', models.TextField()),
                ('budget_min', models.DecimalField(blank=True, decimal_places=2, max_digits=10, null=True)),
                ('budget_max', models.DecimalField(blank=True, decimal_places=2, max_digits=10, null=True)),
                ('currency', models.CharField(default='CAD', max_length=3)),
                ('location_lat', models.FloatField(blank=True, null=True)),
                ('location_lng', models.FloatField(blank=True, null=True)),
                ('location_radius_km', models.PositiveSmallIntegerField(blank=True, null=True)),
                ('remote_allowed', models.BooleanField(default=True)),
                ('deadline', models.DateField(blank=True, null=True)),
                ('status', models.CharField(choices=[('open', 'Open'), ('in_progress', 'In Progress'), ('closed', 'Closed'), ('cancelled', 'Cancelled')], db_index=True, default='open', max_length=20)),
                ('client', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='service_requests', to=settings.AUTH_USER_MODEL)),
                ('required_skills', models.ManyToManyField(blank=True, related_name='client_requests', to='configurations.skill')),
                ('tenant', models.ForeignKey(help_text='The tenant this record belongs to.', on_delete=django.db.models.deletion.CASCADE, related_name='%(app_label)s_%(class)s_set', to='tenants.tenant', verbose_name='Tenant')),
                ('category', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, to='services.servicecategory')),
            ],
            options={
                'verbose_name': 'Client Request',
                'verbose_name_plural': 'Client Requests',
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='ServiceContract',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True, verbose_name='Created at')),
                ('updated_at', models.DateTimeField(auto_now=True, db_index=True, verbose_name='Updated at')),
                ('is_active', models.BooleanField(db_index=True, default=True, help_text='Designates whether this record is active.', verbose_name='Is active')),
                ('uuid', models.UUIDField(default=uuid.uuid4, editable=False, unique=True)),
                ('title', models.CharField(max_length=255)),
                ('description', models.TextField(blank=True)),
                ('agreed_rate', models.DecimalField(db_index=True, decimal_places=2, max_digits=10)),
                ('rate_type', models.CharField(choices=[('fixed', 'Fixed'), ('hourly', 'Hourly')], db_index=True, default='fixed', max_length=20)),
                ('currency', models.CharField(db_index=True, default='CAD', max_length=3)),
                ('agreed_deadline', models.DateField(blank=True, db_index=True, null=True)),
                ('revisions_allowed', models.PositiveSmallIntegerField(default=1)),
                ('revisions_used', models.PositiveSmallIntegerField(default=0)),
                ('platform_fee_percent', models.DecimalField(decimal_places=2, default=Decimal('10.00'), help_text='Platform fee percentage', max_digits=5)),
                ('status', models.CharField(choices=[('draft', 'Draft'), ('pending_payment', 'Pending Payment'), ('funded', 'Funded (Escrow)'), ('in_progress', 'In Progress'), ('delivered', 'Delivered'), ('revision_requested', 'Revision Requested'), ('completed', 'Completed'), ('disputed', 'Disputed'), ('cancelled', 'Cancelled'), ('refunded', 'Refunded')], db_index=True, default='draft', max_length=20)),
                ('started_at', models.DateTimeField(blank=True, db_index=True, null=True)),
                ('delivered_at', models.DateTimeField(blank=True, db_index=True, null=True)),
                ('completed_at', models.DateTimeField(blank=True, db_index=True, null=True)),
                ('cancelled_at', models.DateTimeField(blank=True, db_index=True, null=True)),
                ('cancellation_reason', models.TextField(blank=True)),
                ('client', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='client_contracts', to=settings.AUTH_USER_MODEL)),
                ('client_request', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='contracts', to='services.clientrequest')),
                ('escrow_transaction', models.OneToOneField(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='service_contract', to='escrow.escrowtransaction')),
                ('service', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='contracts', to='services.service')),
                ('tenant', models.ForeignKey(help_text='The tenant this record belongs to.', on_delete=django.db.models.deletion.CASCADE, related_name='%(app_label)s_%(class)s_set', to='tenants.tenant', verbose_name='Tenant')),
            ],
            options={
                'verbose_name': 'Service Contract',
                'verbose_name_plural': 'Service Contracts',
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='CrossTenantServiceRequest',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True, verbose_name='Created at')),
                ('updated_at', models.DateTimeField(auto_now=True, db_index=True, verbose_name='Updated at')),
                ('is_active', models.BooleanField(db_index=True, default=True, help_text='Designates whether this record is active.', verbose_name='Is active')),
                ('uuid', models.UUIDField(default=uuid.uuid4, editable=False, unique=True)),
                ('target_service_uuid', models.UUIDField(db_index=True, help_text='UUID of service in target tenant schema')),
                ('target_tenant_schema', models.CharField(help_text='Schema name of target tenant (provider)', max_length=63)),
                ('target_provider_uuid', models.UUIDField(help_text='UUID of provider in target tenant schema')),
                ('title', models.CharField(help_text='Request title/summary', max_length=255)),
                ('description', models.TextField(help_text='Detailed description of service requirements')),
                ('budget', models.DecimalField(blank=True, decimal_places=2, help_text='Proposed budget for the service', max_digits=10, null=True)),
                ('currency', models.CharField(default='CAD', max_length=3)),
                ('deadline', models.DateField(blank=True, help_text='Desired completion date', null=True)),
                ('attachment_1', models.FileField(blank=True, help_text='Supporting document or file', null=True, upload_to='cross_tenant_requests/')),
                ('attachment_2', models.FileField(blank=True, null=True, upload_to='cross_tenant_requests/')),
                ('status', models.CharField(choices=[('pending', 'Pending Review'), ('accepted', 'Accepted'), ('rejected', 'Rejected'), ('converted', 'Converted to Contract'), ('cancelled', 'Cancelled')], db_index=True, default='pending', max_length=20)),
                ('hiring_context', models.CharField(choices=[('organizational', 'On behalf of tenant/organization'), ('personal', 'Personal user hiring')], db_index=True, default='organizational', help_text='Is this request for organization or personal use?', max_length=20)),
                ('provider_response', models.TextField(blank=True, help_text='Provider response message')),
                ('responded_at', models.DateTimeField(blank=True, db_index=True, help_text='When provider responded', null=True)),
                ('client', models.ForeignKey(help_text='User requesting the service', on_delete=django.db.models.deletion.CASCADE, related_name='cross_tenant_requests_sent', to=settings.AUTH_USER_MODEL)),
                ('tenant', models.ForeignKey(help_text='The tenant this record belongs to.', on_delete=django.db.models.deletion.CASCADE, related_name='%(app_label)s_%(class)s_set', to='tenants.tenant', verbose_name='Tenant')),
                ('contract', models.ForeignKey(blank=True, help_text='Resulting contract if request was accepted', null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='originating_cross_tenant_request', to='services.servicecontract')),
            ],
            options={
                'verbose_name': 'Cross-Tenant Service Request',
                'verbose_name_plural': 'Cross-Tenant Service Requests',
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='ContractMessage',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True, verbose_name='Created at')),
                ('updated_at', models.DateTimeField(auto_now=True, db_index=True, verbose_name='Updated at')),
                ('is_active', models.BooleanField(db_index=True, default=True, help_text='Designates whether this record is active.', verbose_name='Is active')),
                ('content', models.TextField()),
                ('attachments', models.JSONField(blank=True, default=list)),
                ('is_system_message', models.BooleanField(db_index=True, default=False)),
                ('read_at', models.DateTimeField(blank=True, db_index=True, null=True)),
                ('sender', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='contract_messages_sent', to=settings.AUTH_USER_MODEL)),
                ('tenant', models.ForeignKey(help_text='The tenant this record belongs to.', on_delete=django.db.models.deletion.CASCADE, related_name='%(app_label)s_%(class)s_set', to='tenants.tenant', verbose_name='Tenant')),
                ('contract', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='messages', to='services.servicecontract')),
            ],
            options={
                'verbose_name': 'Contract Message',
                'verbose_name_plural': 'Contract Messages',
                'ordering': ['created_at'],
            },
        ),
        migrations.CreateModel(
            name='ServiceImage',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True, verbose_name='Created at')),
                ('updated_at', models.DateTimeField(auto_now=True, db_index=True, verbose_name='Updated at')),
                ('is_active', models.BooleanField(db_index=True, default=True, help_text='Designates whether this record is active.', verbose_name='Is active')),
                ('image', models.ImageField(help_text='Allowed formats: JPG, PNG, GIF, WebP. Max size: 10MB', upload_to='service_images/', validators=[django.core.validators.FileExtensionValidator(allowed_extensions=['jpg', 'jpeg', 'png', 'gif', 'webp'])])),
                ('description', models.CharField(blank=True, max_length=255)),
                ('alt_text', models.CharField(blank=True, max_length=125)),
                ('sort_order', models.PositiveIntegerField(default=0)),
                ('tenant', models.ForeignKey(help_text='The tenant this record belongs to.', on_delete=django.db.models.deletion.CASCADE, related_name='%(app_label)s_%(class)s_set', to='tenants.tenant', verbose_name='Tenant')),
            ],
            options={
                'verbose_name': 'Service Image',
                'verbose_name_plural': 'Service Images',
                'ordering': ['sort_order'],
            },
        ),
        migrations.AddField(
            model_name='service',
            name='images',
            field=models.ManyToManyField(blank=True, related_name='services', to='services.serviceimage'),
        ),
        migrations.CreateModel(
            name='ServiceLike',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True, verbose_name='Created at')),
                ('updated_at', models.DateTimeField(auto_now=True, db_index=True, verbose_name='Updated at')),
                ('is_active', models.BooleanField(db_index=True, default=True, help_text='Designates whether this record is active.', verbose_name='Is active')),
                ('service', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='likes', to='services.service')),
                ('tenant', models.ForeignKey(help_text='The tenant this record belongs to.', on_delete=django.db.models.deletion.CASCADE, related_name='%(app_label)s_%(class)s_set', to='tenants.tenant', verbose_name='Tenant')),
                ('user', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='liked_services', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Service Like',
                'verbose_name_plural': 'Service Likes',
            },
        ),
        migrations.CreateModel(
            name='ServiceProposal',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True, verbose_name='Created at')),
                ('updated_at', models.DateTimeField(auto_now=True, db_index=True, verbose_name='Updated at')),
                ('is_active', models.BooleanField(db_index=True, default=True, help_text='Designates whether this record is active.', verbose_name='Is active')),
                ('uuid', models.UUIDField(default=uuid.uuid4, editable=False, unique=True)),
                ('proposed_rate', models.DecimalField(db_index=True, decimal_places=2, max_digits=10)),
                ('rate_type', models.CharField(choices=[('fixed', 'Fixed'), ('hourly', 'Hourly')], db_index=True, default='fixed', max_length=20)),
                ('estimated_hours', models.PositiveSmallIntegerField(blank=True, null=True)),
                ('cover_letter', models.TextField(validators=[django.core.validators.MaxLengthValidator(10000)])),
                ('proposed_timeline_days', models.PositiveSmallIntegerField(blank=True, null=True)),
                ('attachments', models.JSONField(blank=True, default=list)),
                ('status', models.CharField(choices=[('pending', 'Pending'), ('accepted', 'Accepted'), ('rejected', 'Rejected'), ('withdrawn', 'Withdrawn')], db_index=True, default='pending', max_length=20)),
                ('client_request', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='proposals', to='services.clientrequest')),
                ('tenant', models.ForeignKey(help_text='The tenant this record belongs to.', on_delete=django.db.models.deletion.CASCADE, related_name='%(app_label)s_%(class)s_set', to='tenants.tenant', verbose_name='Tenant')),
            ],
            options={
                'verbose_name': 'Service Proposal',
                'verbose_name_plural': 'Service Proposals',
                'ordering': ['-created_at'],
            },
        ),
        migrations.AddField(
            model_name='servicecontract',
            name='proposal',
            field=models.OneToOneField(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='contract', to='services.serviceproposal'),
        ),
        migrations.CreateModel(
            name='ServiceProvider',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True, verbose_name='Created at')),
                ('updated_at', models.DateTimeField(auto_now=True, db_index=True, verbose_name='Updated at')),
                ('is_active', models.BooleanField(db_index=True, default=True, help_text='Designates whether this record is active.', verbose_name='Is active')),
                ('uuid', models.UUIDField(default=uuid.uuid4, editable=False, unique=True)),
                ('provider_type', models.CharField(choices=[('individual', 'Individual Freelancer'), ('agency', 'Agency'), ('company', 'Company')], default='individual', max_length=20)),
                ('display_name', models.CharField(blank=True, max_length=255)),
                ('bio', models.TextField(blank=True, validators=[django.core.validators.MaxLengthValidator(2000)])),
                ('tagline', models.CharField(blank=True, max_length=200)),
                ('avatar', models.ImageField(blank=True, null=True, upload_to='provider_avatars/')),
                ('cover_image', models.ImageField(blank=True, null=True, upload_to='provider_covers/')),
                ('address', models.CharField(blank=True, max_length=255)),
                ('city', models.CharField(blank=True, max_length=100)),
                ('state', models.CharField(blank=True, max_length=100)),
                ('postal_code', models.CharField(blank=True, max_length=20)),
                ('country', models.CharField(blank=True, default='CA', max_length=100)),
                ('location', django.contrib.gis.db.models.fields.PointField(blank=True, geography=True, null=True, srid=4326)),
                ('location_lat', models.FloatField(blank=True, null=True)),
                ('location_lng', models.FloatField(blank=True, null=True)),
                ('hourly_rate', models.DecimalField(blank=True, db_index=True, decimal_places=2, help_text='Default hourly rate', max_digits=10, null=True)),
                ('minimum_budget', models.DecimalField(blank=True, db_index=True, decimal_places=2, help_text='Minimum project budget', max_digits=10, null=True)),
                ('currency', models.CharField(db_index=True, default='CAD', max_length=3)),
                ('rating_avg', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=3, validators=[django.core.validators.MinValueValidator(0), django.core.validators.MaxValueValidator(5)])),
                ('total_reviews', models.PositiveIntegerField(default=0)),
                ('completed_jobs_count', models.PositiveIntegerField(default=0)),
                ('total_earnings', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=12)),
                ('response_rate', models.PositiveSmallIntegerField(default=0, help_text='Response rate %')),
                ('avg_response_time_hours', models.PositiveSmallIntegerField(default=24)),
                ('availability_status', models.CharField(choices=[('available', 'Available'), ('busy', 'Busy'), ('unavailable', 'Unavailable'), ('on_vacation', 'On Vacation')], db_index=True, default='available', max_length=20)),
                ('is_verified', models.BooleanField(db_index=True, default=False, help_text='KYC verified')),
                ('is_featured', models.BooleanField(db_index=True, default=False)),
                ('marketplace_enabled', models.BooleanField(default=False, help_text='Provider can publish services to public marketplace')),
                ('is_private', models.BooleanField(default=False, help_text='DEPRECATED: Use marketplace_enabled instead. Only visible via direct link')),
                ('is_accepting_work', models.BooleanField(default=True, help_text='Provider is currently accepting new service requests and contracts')),
                ('can_work_remotely', models.BooleanField(default=True)),
                ('can_work_onsite', models.BooleanField(default=False)),
                ('stripe_account_id', models.CharField(blank=True, max_length=255)),
                ('stripe_onboarding_complete', models.BooleanField(default=False)),
                ('stripe_payouts_enabled', models.BooleanField(default=False)),
                ('last_active_at', models.DateTimeField(blank=True, db_index=True, null=True)),
                ('categories', models.ManyToManyField(blank=True, related_name='providers', to='services.servicecategory')),
                ('company', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='service_providers', to='configurations.company')),
                ('tenant', models.ForeignKey(help_text='The tenant this record belongs to.', on_delete=django.db.models.deletion.CASCADE, related_name='%(app_label)s_%(class)s_set', to='tenants.tenant', verbose_name='Tenant')),
                ('user', models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, related_name='service_provider', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Service Provider',
                'verbose_name_plural': 'Service Providers',
                'ordering': ['-rating_avg', '-completed_jobs_count'],
            },
        ),
        migrations.AddField(
            model_name='serviceproposal',
            name='provider',
            field=models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='proposals', to='services.serviceprovider'),
        ),
        migrations.AddField(
            model_name='servicecontract',
            name='provider',
            field=models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='provider_contracts', to='services.serviceprovider'),
        ),
        migrations.AddField(
            model_name='service',
            name='provider',
            field=models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='services', to='services.serviceprovider'),
        ),
        migrations.CreateModel(
            name='ProviderSkill',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True, verbose_name='Created at')),
                ('updated_at', models.DateTimeField(auto_now=True, db_index=True, verbose_name='Updated at')),
                ('is_active', models.BooleanField(db_index=True, default=True, help_text='Designates whether this record is active.', verbose_name='Is active')),
                ('level', models.CharField(choices=[('beginner', 'Beginner'), ('intermediate', 'Intermediate'), ('advanced', 'Advanced'), ('expert', 'Expert')], db_index=True, default='beginner', max_length=20)),
                ('years_experience', models.PositiveSmallIntegerField(default=0)),
                ('is_verified', models.BooleanField(db_index=True, default=False)),
                ('skill', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='provider_skills', to='configurations.skill')),
                ('tenant', models.ForeignKey(help_text='The tenant this record belongs to.', on_delete=django.db.models.deletion.CASCADE, related_name='%(app_label)s_%(class)s_set', to='tenants.tenant', verbose_name='Tenant')),
                ('provider', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='provider_skills', to='services.serviceprovider')),
            ],
            options={
                'verbose_name': 'Provider Skill',
                'verbose_name_plural': 'Provider Skills',
            },
        ),
        migrations.CreateModel(
            name='ProviderMatch',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True, verbose_name='Created at')),
                ('updated_at', models.DateTimeField(auto_now=True, db_index=True, verbose_name='Updated at')),
                ('is_active', models.BooleanField(db_index=True, default=True, help_text='Designates whether this record is active.', verbose_name='Is active')),
                ('score', models.DecimalField(decimal_places=4, help_text='Match score 0-1', max_digits=5)),
                ('score_breakdown', models.JSONField(blank=True, default=dict)),
                ('viewed_by_client', models.BooleanField(default=False)),
                ('accepted_by_client', models.BooleanField(default=False)),
                ('rejected_by_client', models.BooleanField(default=False)),
                ('client_request', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='matches', to='services.clientrequest')),
                ('tenant', models.ForeignKey(help_text='The tenant this record belongs to.', on_delete=django.db.models.deletion.CASCADE, related_name='%(app_label)s_%(class)s_set', to='tenants.tenant', verbose_name='Tenant')),
                ('provider', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='matches', to='services.serviceprovider')),
            ],
            options={
                'verbose_name': 'Provider Match',
                'verbose_name_plural': 'Provider Matches',
                'ordering': ['-score'],
            },
        ),
        migrations.CreateModel(
            name='ServiceReview',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True, verbose_name='Created at')),
                ('updated_at', models.DateTimeField(auto_now=True, db_index=True, verbose_name='Updated at')),
                ('is_active', models.BooleanField(db_index=True, default=True, help_text='Designates whether this record is active.', verbose_name='Is active')),
                ('rating', models.PositiveSmallIntegerField(validators=[django.core.validators.MinValueValidator(1), django.core.validators.MaxValueValidator(5)])),
                ('rating_communication', models.PositiveSmallIntegerField(blank=True, null=True, validators=[django.core.validators.MinValueValidator(1), django.core.validators.MaxValueValidator(5)])),
                ('rating_quality', models.PositiveSmallIntegerField(blank=True, null=True, validators=[django.core.validators.MinValueValidator(1), django.core.validators.MaxValueValidator(5)])),
                ('rating_timeliness', models.PositiveSmallIntegerField(blank=True, null=True, validators=[django.core.validators.MinValueValidator(1), django.core.validators.MaxValueValidator(5)])),
                ('title', models.CharField(blank=True, max_length=200)),
                ('content', models.TextField(blank=True, validators=[django.core.validators.MaxLengthValidator(5000)])),
                ('provider_response', models.TextField(blank=True, validators=[django.core.validators.MaxLengthValidator(5000)])),
                ('provider_responded_at', models.DateTimeField(blank=True, db_index=True, null=True)),
                ('contract', models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, related_name='review', to='services.servicecontract')),
                ('provider', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='reviews', to='services.serviceprovider')),
                ('reviewer', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='service_reviews_given', to=settings.AUTH_USER_MODEL)),
                ('tenant', models.ForeignKey(help_text='The tenant this record belongs to.', on_delete=django.db.models.deletion.CASCADE, related_name='%(app_label)s_%(class)s_set', to='tenants.tenant', verbose_name='Tenant')),
            ],
            options={
                'verbose_name': 'Service Review',
                'verbose_name_plural': 'Service Reviews',
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='ServiceTag',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True, verbose_name='Created at')),
                ('updated_at', models.DateTimeField(auto_now=True, db_index=True, verbose_name='Updated at')),
                ('is_active', models.BooleanField(db_index=True, default=True, help_text='Designates whether this record is active.', verbose_name='Is active')),
                ('name', models.CharField(max_length=50)),
                ('slug', models.SlugField(blank=True)),
                ('tenant', models.ForeignKey(help_text='The tenant this record belongs to.', on_delete=django.db.models.deletion.CASCADE, related_name='%(app_label)s_%(class)s_set', to='tenants.tenant', verbose_name='Tenant')),
            ],
            options={
                'verbose_name': 'Service Tag',
                'verbose_name_plural': 'Service Tags',
            },
        ),
        migrations.AddField(
            model_name='service',
            name='tags',
            field=models.ManyToManyField(blank=True, related_name='services', to='services.servicetag'),
        ),
        migrations.AddConstraint(
            model_name='servicecategory',
            constraint=models.UniqueConstraint(fields=('tenant', 'slug'), name='services_category_unique_tenant_slug'),
        ),
        migrations.AddIndex(
            model_name='crosstenantservicerequest',
            index=models.Index(fields=['status', '-created_at'], name='cross_req_status_created'),
        ),
        migrations.AddIndex(
            model_name='crosstenantservicerequest',
            index=models.Index(fields=['target_tenant_schema'], name='cross_req_target_tenant'),
        ),
        migrations.AddConstraint(
            model_name='servicelike',
            constraint=models.UniqueConstraint(fields=('user', 'service'), name='services_like_unique_user_service'),
        ),
        migrations.AddConstraint(
            model_name='serviceproposal',
            constraint=models.UniqueConstraint(fields=('client_request', 'provider'), name='services_proposal_unique_request_provider'),
        ),
        migrations.AddConstraint(
            model_name='providerskill',
            constraint=models.UniqueConstraint(fields=('provider', 'skill'), name='services_providerskill_unique_provider_skill'),
        ),
        migrations.AddConstraint(
            model_name='providermatch',
            constraint=models.UniqueConstraint(fields=('client_request', 'provider'), name='services_match_unique_request_provider'),
        ),
        migrations.AddConstraint(
            model_name='servicetag',
            constraint=models.UniqueConstraint(fields=('tenant', 'slug'), name='services_tag_unique_tenant_slug'),
        ),
        migrations.AddConstraint(
            model_name='service',
            constraint=models.UniqueConstraint(fields=('tenant', 'provider', 'slug'), name='services_service_unique_tenant_provider_slug'),
        ),
    ]
