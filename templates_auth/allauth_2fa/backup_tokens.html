{% extends "base/freelanhub_base.html" %}
{% load static i18n %}

{% block title %}{% trans "Backup Codes" %} - FreelanHub{% endblock %}

{% block meta_description %}{% trans "Manage your two-factor authentication backup codes for FreelanHub account recovery.\" %}{% endblock %}

{% block content %}

<!-- Backup Codes -->
<section class="form_login lg:py-20 sm:py-14 py-10">
    <div class="container flex items-center justify-center">
        <div class="content sm:w-[560px] w-full">
            <!-- Backup Icon -->
            <div class="w-20 h-20 mx-auto mb-6 bg-purple-100 rounded-full flex items-center justify-center">
                <span class="ph-fill ph-key text-5xl text-purple-600"></span>
            </div>

            <h3 class="heading3 text-center">{% trans "Backup Codes" %}</h3>
            <p class="body2 text-secondary text-center mt-3">
                {% trans "Use these codes if you lose access to your authenticator" %}
            </p>

            {% if backup_tokens %}
                {% if reveal_tokens %}
                <!-- Display newly generated tokens -->
                <div class="mt-8 p-6 bg-green-50 border border-green-200 rounded-lg">
                    <div class="flex items-start gap-2 mb-4">
                        <span class="ph-fill ph-check-circle text-green-600 text-2xl flex-shrink-0"></span>
                        <p class="body2 text-green-800 font-medium">{% trans "New backup codes generated! Save these in a safe place." %}</p>
                    </div>
                    <div class="grid grid-cols-2 gap-3 mt-4">
                        {% for token in backup_tokens %}
                        <div class="bg-white px-4 py-3 rounded-lg border border-green-300 text-center font-mono text-sm font-medium">
                            {{ token.token }}
                        </div>
                        {% endfor %}
                    </div>
                </div>

                <div class="mt-6 p-4 bg-yellow-50 border-l-4 border-yellow-400 rounded-lg">
                    <div class="flex items-start gap-3">
                        <span class="ph-fill ph-warning text-yellow-600 text-2xl flex-shrink-0"></span>
                        <div class="text-sm">
                            <p class="font-medium text-yellow-800 mb-2">{% trans "Save these codes now!" %}</p>
                            <ul class="list-disc list-inside space-y-1 text-yellow-700">
                                <li>{% trans "Each code can only be used once" %}</li>
                                <li>{% trans "Store them in a secure location (password manager, safe, etc.)" %}</li>
                                <li>{% trans "These codes won't be shown again" %}</li>
                            </ul>
                        </div>
                    </div>
                </div>
                {% else %}
                <!-- Tokens exist but not revealed -->
                <div class="mt-8 p-6 bg-surface rounded-lg">
                    <div class="flex items-start gap-3">
                        <span class="ph-fill ph-lock text-gray-500 text-2xl flex-shrink-0"></span>
                        <p class="body2 text-secondary">{% trans "You have backup codes, but they are hidden for security. Generate new codes if you need to see them." %}</p>
                    </div>
                </div>
                {% endif %}
            {% else %}
            <!-- No tokens exist -->
            <div class="mt-8 p-6 bg-surface rounded-lg">
                <div class="flex items-start gap-3">
                    <span class="ph-fill ph-info text-gray-500 text-2xl flex-shrink-0"></span>
                    <p class="body2 text-secondary">{% trans "You don't have any backup codes yet. Generate them to ensure account access if you lose your authenticator device." %}</p>
                </div>
            </div>
            {% endif %}

            <!-- Action Buttons -->
            <form method="post" class="mt-8">
                {% csrf_token %}
                <div class="space-y-3">
                    <button type="submit" name="action" value="generate" class="button-main bg-primary w-full text-center">
                        {% trans "Generate New Backup Codes" %}
                    </button>
                    <a href="{% url 'account_settings' %}" class="button-secondary w-full text-center block">
                        {% trans "Back to Settings" %}
                    </a>
                </div>
            </form>

            <!-- Help Text -->
            <div class="mt-6 p-4 bg-blue-50 rounded-lg">
                <h4 class="text-sm font-medium text-blue-900 mb-2">{% trans "What are backup codes?" %}</h4>
                <p class="text-sm text-blue-700">{% trans "Backup codes allow you to access your account if you lose your phone or authenticator app. Keep them somewhere safe and don't share them with anyone." %}</p>
            </div>
        </div>
    </div>
</section>

{% endblock %}
