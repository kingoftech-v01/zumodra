{% extends "account/base.html" %}
{% load i18n static %}

{% block head_title %}{% trans "Complete Sign Up" %} - Zumodra{% endblock %}

{% block content %}
<div class="text-center mb-6">
    <div class="mx-auto w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mb-4">
        <span class="ph-bold ph-user-plus text-3xl text-blue-600"></span>
    </div>
    <h1 class="text-2xl font-bold text-gray-900 mb-2">{% trans "Complete Your Profile" %}</h1>
    <p class="text-gray-600">{% blocktrans with provider_name=account.get_provider.name %}Almost there! Just a few more details to finish signing up with {{ provider_name }}.{% endblocktrans %}</p>
</div>

{# Provider Info #}
<div class="mb-6 p-4 bg-green-50 border-l-4 border-green-500 rounded-r-lg">
    <div class="flex items-start">
        <span class="ph-bold ph-check-circle text-green-500 text-lg mr-2 flex-shrink-0"></span>
        <div class="text-sm text-green-700">
            {% blocktrans with provider_name=account.get_provider.name %}Your {{ provider_name }} account has been verified. Please complete the form below to finish creating your account.{% endblocktrans %}
        </div>
    </div>
</div>

<form id="signup_form" method="post" action="{% url 'socialaccount_signup' %}" class="space-y-4">
    {% csrf_token %}

    {# Email Field #}
    {% if form.email %}
    <div>
        <label for="id_email" class="block text-sm font-medium text-gray-700 mb-1">
            {% trans "Email address" %} <span class="text-red-500">*</span>
        </label>
        <div class="relative">
            <span class="absolute left-3 top-1/2 -translate-y-1/2 text-gray-400">
                <span class="ph-bold ph-envelope text-lg"></span>
            </span>
            <input type="email"
                   name="email"
                   id="id_email"
                   class="w-full pl-10 pr-4 py-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors {% if form.email.errors %}border-red-500{% endif %}"
                   value="{{ form.email.value|default:'' }}"
                   placeholder="{% trans 'you@example.com' %}"
                   autocomplete="email"
                   required>
        </div>
        {% if form.email.errors %}
        <p class="mt-1 text-sm text-red-600">{{ form.email.errors.0 }}</p>
        {% endif %}
    </div>
    {% endif %}

    {# Username Field (if applicable) #}
    {% if form.username %}
    <div>
        <label for="id_username" class="block text-sm font-medium text-gray-700 mb-1">
            {% trans "Username" %} <span class="text-red-500">*</span>
        </label>
        <div class="relative">
            <span class="absolute left-3 top-1/2 -translate-y-1/2 text-gray-400">
                <span class="ph-bold ph-user text-lg"></span>
            </span>
            <input type="text"
                   name="username"
                   id="id_username"
                   class="w-full pl-10 pr-4 py-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors {% if form.username.errors %}border-red-500{% endif %}"
                   value="{{ form.username.value|default:'' }}"
                   placeholder="{% trans 'Choose a username' %}"
                   autocomplete="username"
                   required>
        </div>
        {% if form.username.errors %}
        <p class="mt-1 text-sm text-red-600">{{ form.username.errors.0 }}</p>
        {% endif %}
    </div>
    {% endif %}

    {# Additional form fields #}
    {% for field in form %}
        {% if field.name != 'email' and field.name != 'username' %}
            {% if not field.is_hidden %}
            <div>
                <label for="{{ field.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-1">
                    {{ field.label }}
                    {% if field.field.required %}<span class="text-red-500">*</span>{% endif %}
                </label>
                {{ field }}
                {% if field.errors %}
                <p class="mt-1 text-sm text-red-600">{{ field.errors.0 }}</p>
                {% endif %}
                {% if field.help_text %}
                <p class="mt-1 text-xs text-gray-500">{{ field.help_text }}</p>
                {% endif %}
            </div>
            {% else %}
                {{ field }}
            {% endif %}
        {% endif %}
    {% endfor %}

    {% if redirect_field_value %}
    <input type="hidden" name="{{ redirect_field_name }}" value="{{ redirect_field_value }}" />
    {% endif %}

    {# Submit Button #}
    <button type="submit"
            class="w-full flex items-center justify-center gap-2 px-4 py-3 bg-blue-600 text-white font-semibold rounded-lg hover:bg-blue-700 focus:ring-4 focus:ring-blue-300 transition-all duration-200">
        <span class="ph-bold ph-user-plus text-lg"></span>
        {% trans "Complete Sign Up" %}
    </button>
</form>

{# Form Errors #}
{% if form.non_field_errors %}
<div class="mt-4 p-4 bg-red-50 border-l-4 border-red-500 rounded-r-lg">
    <div class="flex items-start">
        <span class="ph-bold ph-warning-circle text-red-500 text-lg mr-2 flex-shrink-0"></span>
        <div class="text-sm text-red-700">
            {% for error in form.non_field_errors %}
            <p>{{ error }}</p>
            {% endfor %}
        </div>
    </div>
</div>
{% endif %}

{# Terms #}
<p class="mt-6 text-center text-xs text-gray-500">
    {% blocktrans %}By signing up, you agree to our <a href="/terms/" class="text-blue-600 hover:underline">Terms of Service</a> and <a href="/privacy/" class="text-blue-600 hover:underline">Privacy Policy</a>.{% endblocktrans %}
</p>
{% endblock content %}
